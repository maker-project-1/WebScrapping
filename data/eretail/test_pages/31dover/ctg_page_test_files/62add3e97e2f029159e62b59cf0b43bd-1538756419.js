
Validation.defaultOptions.immediate=true;Validation.defaultOptions.addClassNameToContainer=true;Event.observe(document,'dom:loaded',function(){var inputs=$$('ul.options-list input');for(var i=0,l=inputs.length;i<l;i++){inputs[i].addClassName('change-container-classname');}})
if(!window.Enterprise){window.Enterprise={};}
Enterprise.templatesPattern=/(^|.|\r|\n)(\{\{(.*?)\}\})/;Enterprise.TopCart={initialize:function(container){this.container=$(container);this.element=this.container.up(0);this.elementHeader=this.container.previous(0);this.intervalDuration=1000;this.interval=null;this.onElementMouseOut=this.handleMouseOut.bindAsEventListener(this);this.onElementMouseOver=this.handleMouseOver.bindAsEventListener(this);this.onElementMouseClick=this.handleMouseClick.bindAsEventListener(this);this.element.observe('mouseout',this.onElementMouseOut);this.element.observe('mouseover',this.onElementMouseOver);this.elementHeader.observe('click',this.onElementMouseClick);},handleMouseOut:function(evt){if($(this.elementHeader).hasClassName('expanded')){this.interval=setTimeout(this.hideCart.bind(this),this.intervalDuration);}},handleMouseOver:function(evt){if(this.interval!==null){clearTimeout(this.interval);this.interval=null;}},handleMouseClick:function(evt){if(!$(this.elementHeader).hasClassName('expanded')&&!$(this.container.id).hasClassName('process')){this.showCart();}
else{this.hideCart();}},showCart:function(timePeriod){this.container.parentNode.style.zIndex=992;new Effect.SlideDown(this.container.id,{duration:0.5,beforeStart:function(effect){$(effect.element.id).addClassName('process');},afterFinish:function(effect){$(effect.element.id).removeClassName('process');}});$(this.elementHeader).addClassName('expanded');if(timePeriod){this.timePeriod=timePeriod*1000;this.interval=setTimeout(this.hideCart.bind(this),this.timePeriod);}},hideCart:function(){if(!$(this.container.id).hasClassName('process')&&$(this.elementHeader).hasClassName('expanded')){new Effect.SlideUp(this.container.id,{duration:0.5,beforeStart:function(effect){$(effect.element.id).addClassName('process');},afterFinish:function(effect){$(effect.element.id).removeClassName('process');effect.element.parentNode.style.zIndex=1;}});}
if(this.interval!==null){clearTimeout(this.interval);this.interval=null;}
$(this.elementHeader).removeClassName('expanded');}};Enterprise.Bundle={oldReloadPrice:false,initialize:function(){this.slider=$('bundleProduct');this.xOffset=$('bundle-product-wrapper').getDimensions().width;},swapReloadPrice:function(){Enterprise.Bundle.oldReloadPrice=Product.Bundle.prototype.reloadPrice;Product.Bundle.prototype.reloadPrice=Enterprise.Bundle.reloadPrice;Product.Bundle.prototype.selection=Enterprise.Bundle.selection;},reloadPrice:function(){var result=Enterprise.Bundle.oldReloadPrice.bind(this)();var priceContainer,duplicateContainer=null
if(priceContainer=$('bundle-product-wrapper').down('.price-box .price-as-configured')){if(duplicateContainer=$('bundle-product-wrapper').down('.duplicate-price-box .price-as-configured')){duplicateContainer.down('.price').update(priceContainer.down('.price').innerHTML);}}
if(!this.summaryTemplate&&$('bundle-summary-template')){this.summaryTemplate=new Template($('bundle-summary-template').innerHTML,Enterprise.templatesPattern);this.optionTemplate=new Template($('bundle-summary-option-template').innerHTML,Enterprise.templatesPattern);this.optionMultiTemplate=new Template($('bundle-summary-option-multi-template').innerHTML,Enterprise.templatesPattern);}
if(this.summaryTemplate&&$('bundle-summary')){var summaryHTML='';for(var option in this.config.options){if(typeof(this.config.selected[option])!=='undefined'){var optionHTML='';for(var i=0,l=this.config.selected[option].length;i<l;i++){var selection=this.selection(option,this.config.selected[option][i]);if(selection&&this.config.options[option].isMulti){optionHTML+=this.optionMultiTemplate.evaluate(selection);}else if(selection){optionHTML+=this.optionTemplate.evaluate(selection);}}
if(optionHTML.length>0){summaryHTML+=this.summaryTemplate.evaluate({label:this.config.options[option].title.escapeHTML(),options:optionHTML});}}}
if(typeof($('bundle-summary').update(summaryHTML).childElements().last())!='undefined'){$('bundle-summary').update(summaryHTML).childElements().last().addClassName('last');}}
return result;},selection:function(optionId,selectionId){if(selectionId==''||selectionId=='none'){return false;}
var qty=null;if(this.config.options[optionId].selections[selectionId].customQty==1&&!this.config['options'][optionId].isMulti){if($('bundle-option-'+optionId+'-qty-input')){qty=$('bundle-option-'+optionId+'-qty-input').value;}else{qty=1;}}else{qty=this.config.options[optionId].selections[selectionId].qty;}
return{qty:qty,name:this.config.options[optionId].selections[selectionId].name.escapeHTML()};},start:function(){if(!$('bundle-product-wrapper').hasClassName('moving-now')){new Effect.Move(this.slider,{x:-this.xOffset,y:0,mode:'relative',duration:1.5,beforeStart:function(effect){$('bundle-product-wrapper').setStyle({height:$('productView').getHeight()+'px'});$('options-container').show();Enterprise.BundleSummary.initialize();$('bundle-product-wrapper').addClassName('moving-now');},afterFinish:function(effect){$('bundle-product-wrapper').setStyle({height:'auto'});$('productView').hide();$('bundle-product-wrapper').removeClassName('moving-now');}});}},end:function(){if(!$('bundle-product-wrapper').hasClassName('moving-now')){new Effect.Move(this.slider,{x:this.xOffset,y:0,mode:'relative',duration:1.5,beforeStart:function(effect){$('bundle-product-wrapper').setStyle({height:$('options-container').getHeight()+'px'});$('productView').show();$('bundle-product-wrapper').addClassName('moving-now');},afterFinish:function(effect){$('bundle-product-wrapper').setStyle({height:'auto'});$('options-container').hide();Enterprise.BundleSummary.exitSummary();$('bundle-product-wrapper').removeClassName('moving-now');}});}}};Enterprise.BundleSummary={initialize:function(){this.summary=$('bundleSummary');this.summaryOffsetTop=$('customizeTitle').getDimensions().height;this.summary.setStyle({top:this.summaryOffsetTop+"px"});this.summaryContainer=this.summary.up(0);this.doNotCheck=false;this.summaryStartY=this.summary.positionedOffset().top;this.summaryStartY=this.summaryOffsetTop;this.summaryStartX=this.summary.positionedOffset().left;this.onDocScroll=this.handleDocScroll.bindAsEventListener(this);this.GetScroll=setInterval(this.onDocScroll,50);this.onEffectEnds=this.effectEnds.bind(this);},handleDocScroll:function(){if(this.currentOffsetTop==document.viewport.getScrollOffsets().top&&(this.checkOffset(null)==null)){return;}else{if(this.currentOffsetTop==document.viewport.getScrollOffsets().top){this.doNotCheck=true;}
this.currentOffsetTop=document.viewport.getScrollOffsets().top;}
if(this.currentEffect){this.currentEffect.cancel();var topOffset=0;if(this.summaryContainer.viewportOffset().top<-60){topOffset=-(this.summaryContainer.viewportOffset().top);}else{topOffset=this.summaryStartY;}
topOffset=this.checkOffset(topOffset);if(topOffset===null){this.currentEffect=false;return;}
this.currentEffect.start({x:this.summaryStartX,y:topOffset,mode:'absolute',duration:0.3,afterFinish:this.onEffectEnds});return;}
this.currentEffect=new Effect.Move(this.summary);},effectEnds:function(){if(this.doNotCheck==true){this.doNotCheck=false;}},checkOffset:function(offset){if(this.doNotCheck&&offset===null){return null;}
var dimensions=this.summary.getDimensions();var parentDimensions=this.summary.up().getDimensions();if((offset!==null?offset:this.summary.offsetTop)+dimensions.height>=parentDimensions.height){offset=parentDimensions.height-dimensions.height;}else if(offset===null&&this.currentOffsetTop>(this.summaryContainer.viewportOffset().top)&&(this.currentOffsetTop-this.summaryContainer.viewportOffset().top)>this.summary.offsetTop){offset=this.currentOffsetTop-this.summaryContainer.viewportOffset().top;}
return offset;},exitSummary:function(){clearInterval(this.GetScroll);}};Enterprise.Tabs=Class.create();Object.extend(Enterprise.Tabs.prototype,{initialize:function(container){this.container=$(container);this.container.addClassName('tab-list');this.tabs=this.container.select('dt.tab');this.activeTab=this.tabs.first();this.tabs.first().addClassName('first');this.tabs.last().addClassName('last');this.onTabClick=this.handleTabClick.bindAsEventListener(this);for(var i=0,l=this.tabs.length;i<l;i++){this.tabs[i].observe('click',this.onTabClick);}
this.select();},handleTabClick:function(evt){this.activeTab=Event.findElement(evt,'dt');this.select();},select:function(){for(var i=0,l=this.tabs.length;i<l;i++){if(this.tabs[i]==this.activeTab){this.tabs[i].addClassName('active');this.tabs[i].style.zIndex=this.tabs.length+2;new Effect.Appear(this.tabs[i].next('dd'),{duration:0.5});this.tabs[i].parentNode.style.height=this.tabs[i].next('dd').getHeight()+15+'px';}else{this.tabs[i].removeClassName('active');this.tabs[i].style.zIndex=this.tabs.length+1-i;this.tabs[i].next('dd').hide();}}}});Enterprise.Slider=Class.create();Object.extend(Enterprise.Slider.prototype,{initialize:function(container,config){this.container=$(container);this.config={panelCss:'slider-panel',sliderCss:'slider',itemCss:'slider-item',slideButtonCss:'slide-button',slideButtonInactiveCss:'inactive',forwardButtonCss:'forward',backwardButtonCss:'backward',pageSize:6,scrollSize:2,slideDuration:1.0,slideDirection:'horizontal',fadeEffect:true};Object.extend(this.config,config||{});this.items=this.container.select('.'+this.config.itemCss);this.isPlaying=false;this.isAbsolutized=false;this.offset=0;this.onClick=this.handleClick.bindAsEventListener(this);this.sliderPanel=this.container.down('.'+this.config.panelCss);this.slider=this.sliderPanel.down('.'+this.config.sliderCss);this.container.select('.'+this.config.slideButtonCss).each(this.initializeHandlers.bind(this));this.updateButtons();Event.observe(window,'load',this.initializeDimensions.bind(this));},initializeHandlers:function(element){if(element.hasClassName(this.config.forwardButtonCss)||element.hasClassName(this.config.backwardButtonCss)){element.observe('click',this.onClick);}},handleClick:function(evt){var element=Event.element(evt);if(!element.hasClassName(this.config.slideButtonCss)){element=element.up('.'+this.config.slideButtonCss);}
if(!element.hasClassName(this.config.slideButtonInactiveCss)){element.hasClassName(this.config.forwardButtonCss)||this.backward();element.hasClassName(this.config.backwardButtonCss)||this.forward();}
Event.stop(evt);},updateButtons:function(){var buttons=this.container.select('.'+this.config.slideButtonCss);for(var i=0,l=buttons.length;i<l;i++){if(buttons[i].hasClassName(this.config.backwardButtonCss)){if(this.offset<=0){buttons[i].addClassName(this.config.slideButtonInactiveCss);}
else{buttons[i].removeClassName(this.config.slideButtonInactiveCss);}}else if(buttons[i].hasClassName(this.config.forwardButtonCss)){if(this.offset>=this.items.length-this.config.pageSize){buttons[i].addClassName(this.config.slideButtonInactiveCss);}
else{buttons[i].removeClassName(this.config.slideButtonInactiveCss);}}}},initializeDimensions:function(){if((this.config.slideDirection=='horizontal'&&this.sliderPanel.style.width)||(this.config.slideDirection!='horizontal'&&this.sliderPanel.style.height)){return this;}
var firstItem=this.items.first();var offset=0;if(this.config.slideDirection=='horizontal'){offset=(parseInt(firstItem.getStyle('margin-left'))+parseInt(firstItem.getStyle('margin-right')))*(this.config.pageSize-1);this.sliderPanel.setStyle({width:(firstItem.getDimensions().width*this.config.pageSize+offset)+'px'});}else{offset=(parseInt(firstItem.getStyle('margin-bottom'))+parseInt(firstItem.getStyle('margin-top')))*(this.config.pageSize-1);this.sliderPanel.setStyle({height:(firstItem.getDimensions().height*this.config.pageSize+offset)+'px'});}
var dimensions=this.sliderPanel.getDimensions();var sliderParent=this.sliderPanel.up();sliderParent.setStyle({width:dimensions.width+'px',height:dimensions.height+'px'});return this;},absolutize:function(){if(!this.isAbsolutized){this.isAbsolutized=true;var dimensions=this.sliderPanel.getDimensions();this.sliderPanel.setStyle({height:dimensions.height+'px',width:dimensions.width+'px'});this.slider.absolutize();}},forward:function(){if(this.offset+this.config.pageSize<=this.items.length-1){this.slide(true);}},backward:function(){if(this.offset>0){this.slide(false);}},slide:function(isForward){if(this.isPlaying){return;}
this.absolutize();this.effectConfig={duration:this.config.slideDuration};if(this.config.slideDirection=='horizontal'){this.effectConfig.x=this.getSlidePosition(isForward).left;}else{this.effectConfig.y=this.getSlidePosition(isForward).top;}
this.start();},start:function()
{if(this.config.fadeEffect){this.fadeIn();}else{this.move();}},fadeIn:function()
{new Effect.Fade(this.slider.up('div.slider-panel'),{from:1.0,to:0.5,afterFinish:this.move.bind(this),beforeStart:this.effectStarts.bind(this),duration:0.3});},fadeOut:function()
{new Effect.Fade(this.slider.up('div.slider-panel'),{from:0.5,to:1.0,afterFinish:this.effectEnds.bind(this),duration:0.3});},move:function()
{if(this.config.fadeEffect){this.effectConfig.afterFinish=this.fadeOut.bind(this);}else{this.effectConfig.afterFinish=this.effectEnds.bind(this);this.effectConfig.beforeStart=this.effectStarts.bind(this);}
new Effect.Move(this.slider,this.effectConfig);},effectStarts:function(){this.isPlaying=true;},effectEnds:function(){this.isPlaying=false;this.updateButtons();},getSlidePosition:function(isForward){var targetOffset;if(isForward){targetOffset=Math.min(this.items.length-this.config.pageSize,this.offset+this.config.scrollSize)}
else{targetOffset=Math.max(this.offset-this.config.scrollSize,0);}
this.offset=targetOffset;var item=this.items[targetOffset];var itemOffset={left:0,top:0};itemOffset.left=-(item.cumulativeOffset().left
-this.slider.cumulativeOffset().left+this.slider.offsetLeft);itemOffset.top=-(item.cumulativeOffset().top
-this.slider.cumulativeOffset().top+this.slider.offsetTop);return itemOffset;}});Enterprise.PopUpMenu={currentPopUp:null,documentHandlerInitialized:false,popUpZIndex:994,hideDelay:2000,hideOnClick:true,hideInterval:null,initializeDocumentHandler:function(){if(!this.documentHandlerInitialized){this.documentHandlerInitialized=true;Event.observe(document.body,'click',this.handleDocumentClick.bindAsEventListener(this));}},handleDocumentClick:function(evt){if(this.currentPopUp!==null){var element=Event.element(evt);if(!this.currentPopUp.onlyShowed&&this.hideOnClick){this.hide();}else{this.currentPopUp.onlyShowed=false;}}},handlePopUpOver:function(evt){if(this.currentPopUp!==null){this.currentPopUp.removeClassName('faded');this.resetTimeout(0);}},handlePopUpOut:function(evt){if(this.currentPopUp!==null){this.currentPopUp.addClassName('faded');this.resetTimeout(1);}},show:function(trigger){this.initializeDocumentHandler();var container=$(trigger).up('.switch-wrapper');if(!$('popId-'+container.id)){return;}
if(this.currentPopUp!==null&&$('popId-'+container.id)!==this.currentPopUp){this.hide(true);}else if(this.currentPopUp!==null&&this.currentPopUp===$('popId-'+container.id)){this.hide();return;}
this.currentPopUp=$('popId-'+container.id);this.currentPopUp.container=container;this.currentPopUp.container.oldZIndex=this.currentPopUp.container.style.zIndex;this.currentPopUp.container.style.zIndex=this.popUpZIndex;new Effect.Appear(this.currentPopUp,{duration:0.3});if(!this.currentPopUp.isHandled){this.currentPopUp.observe('mouseover',this.handlePopUpOver.bindAsEventListener(this));this.currentPopUp.observe('mouseout',this.handlePopUpOut.bindAsEventListener(this));this.currentPopUp.isHandled=true;}
this.currentPopUp.onlyShowed=true;this.currentPopUp.container.down('.switcher').addClassName('list-opened');this.resetTimeout(2);},hide:function(){if(this.currentPopUp!==null){if(arguments.length==0){new Effect.Fade(this.currentPopUp,{duration:0.3});}else{this.currentPopUp.hide();}
this.currentPopUp.container.style.zIndex=this.currentPopUp.container.oldZIndex;this.resetTimeout(0);this.currentPopUp.container.down('.switcher').removeClassName('list-opened');this.currentPopUp=null;}},resetTimeout:function(delay){if(this.hideTimeout!==null){clearTimeout(this.hideTimeout);this.hideTimeout=null;}
if(delay){this.hideTimeout=setTimeout(this.hide.bind(this),this.hideDelay*delay);}}};function popUpMenu(element){Enterprise.PopUpMenu.show(element);}
jQuery(document).ready(function(){cognesiaTrackingInit();});var cognesiaTrackingInit=function(){jQuery('#newsletter-validate-detail .button').click(function(){var email=jQuery('#newsletter-validate-detail #newsletter').val();if(email!='')
cognesiaTracking('newsletter-signup',email);});jQuery('#contactForm .btn_pass').click(function(){var email=jQuery('#contactForm #email').val();var customerName=jQuery('#contactForm #name').val();if(email!='')
cognesiaTracking('contact-form',email,customerName);});jQuery("#onestepcheckout-place-order").click(function(){var email=iCoCustomerEmail;if(!email||email==''){email=jQuery('#guest_login_form #login-email2').val()||customerCheckoutEmail;}
var customerName=jQuery('#billing\\:firstname').val()+' '+jQuery('#billing\\:lastname').val();if(email!='')
cognesiaTracking('checkout-form',email,customerName);});};var cognesiaTracking=function(formId,email,customerName,customerId,additional){try{customerName=customerName||iCoCustomerName;email=email||iCoCustomerEmail;customerId=customerId||iCoCustomerId;if(typeof iCognesia!="undefined"&&email!=''){iCognesia.RegForm(formId,customerName,email,customerId,["country=UK","interests=","website=www.31dover.com"]);}}catch(e){}};
if(!window.Enterprise){window.Enterprise={};}
if(!Enterprise.CatalogEvent){Enterprise.CatalogEvent={};}
Enterprise.CatalogEvent.Ticker=Class.create();Object.extend(Enterprise.CatalogEvent.Ticker.prototype,{initialize:function(container,seconds){this.container=$(container);this.seconds=seconds;this.start=new Date();this.interval=setInterval(this.applyTimer.bind(this),1000);this.applyTimer();},getEstimate:function(){var now=new Date();var result=this.seconds-(now.getTime()-this.start.getTime())/1000;if(result<0){return 0;}
return Math.round(result);},applyTimer:function(){var seconds=this.getEstimate();var daySec=Math.floor(seconds/(3600*24))*(3600*24);var hourSec=Math.floor(seconds/3600)*3600;var minuteSec=Math.floor(seconds/60)*60;var secondSec=seconds;this.container.down('.days').update(this.formatNumber(Math.floor(daySec/(3600*24))));this.container.down('.hour').update(this.formatNumber(Math.floor((hourSec-daySec)/3600)));this.container.down('.minute').update(this.formatNumber(Math.floor((minuteSec-hourSec)/60)));this.container.down('.second').update(this.formatNumber(seconds-minuteSec));if(daySec>0){this.container.down('.second').previous('.delimiter').hide();this.container.down('.second').hide();this.container.down('.days').show();this.container.down('.days').next('.delimiter').show();}else{this.container.down('.days').hide();this.container.down('.days').next('.delimiter').hide();this.container.down('.second').previous('.delimiter').show();this.container.down('.second').show();}},formatNumber:function(number){if(number<10){return'0'+number.toString();}
return number.toString();}});
jQuery().ready(function(){jQuery('.nav_top_title').live('click',function(){jQuery(this).toggleClass('selected').next().slideToggle('fast');return false;});if(("ontouchstart"in document.documentElement)){jQuery('button').on('click touchend',function(e){jQuery(this).click();});}});var responsive=false;jQuery(document).ready(function(){var wi=jQuery(window).width();if(wi<=960){initMobileNav();initHomePageBlocks();initCategoryPages();}
if(wi<=1080){initHomePageBlocks();}});function initMobileNav(){jQuery('#nav .level0.parent > a').click(function(){var $this=jQuery(this);if($this.hasClass('selected')){$this.next().slideToggle();$this.removeClass('selected');}else{jQuery('#nav .level0.parent > a.selected').removeClass('selected').next().slideToggle();$this.next().slideToggle();$this.addClass('selected')}
return false;});if(("ontouchstart"in document.documentElement)){jQuery('#nav .level1 a').on('click touchend',function(e){window.location=jQuery(this).attr('href');});}}
function initCartPage(){if(jQuery('#cart_bottom_discount_desktop').length>0&&jQuery('#cart_bottom_discount_mobile').length>0){jQuery("#cart_bottom_discount_desktop").detach().appendTo('#cart_bottom_discount_mobile')}
if(jQuery('#giftbox_container').length>0){jQuery("#giftbox_container").addClass('mobile')}
if(jQuery('#cart_cross_inside_desktop').length>0&&jQuery('#cart_cross_inside_mobile').length>0){jQuery("#cart_cross_inside_desktop").detach().appendTo('#cart_cross_inside_mobile')}}
function initHomePageBlocks(){jQuery('.home_contents .img_block .overlay_content button').each(function(){var location=jQuery(this).attr('onclick');if(location){jQuery(this).closest('li').attr('onclick',location);}});}
var FORMALIZE=(function($,window,document,undefined){function IE(version){var b=document.createElement('b');b.innerHTML='<!--[if IE '+version+']><br><![endif]-->';return!!b.getElementsByTagName('br').length;}
var PLACEHOLDER_SUPPORTED='placeholder'in document.createElement('input');var AUTOFOCUS_SUPPORTED='autofocus'in document.createElement('input');var IE6=IE(6);var IE7=IE(7);return{go:function(){var i,j=this.init;for(i in j){j.hasOwnProperty(i)&&j[i]();}},init:{full_input_size:function(){if(!IE7||!$('textarea, input.input_full').length){return;}
$('textarea, input.input_full').wrap('<span class="input_full_wrap"></span>');},ie6_skin_inputs:function(){if(!IE6||!$('input, select, textarea').length){return;}
var button_regex=/button|submit|reset/;var type_regex=/date|datetime|datetime-local|email|month|number|password|range|search|tel|text|time|url|week/;$('input').each(function(){var el=$(this);if(this.getAttribute('type').match(button_regex)){el.addClass('ie6_button');if(this.disabled){el.addClass('ie6_button_disabled');}}
else if(this.getAttribute('type').match(type_regex)){el.addClass('ie6_input');if(this.disabled){el.addClass('ie6_input_disabled');}}});$('textarea, select').each(function(){if(this.disabled){$(this).addClass('ie6_input_disabled');}});},autofocus:function(){if(AUTOFOCUS_SUPPORTED||!$(':input[autofocus]').length){return;}
$(':input[autofocus]:visible:first').focus();},placeholder:function(){if(PLACEHOLDER_SUPPORTED||!$(':input[placeholder]').length){return;}
FORMALIZE.misc.add_placeholder();$(':input[placeholder]').each(function(){if(this.type==='password'){return;}
var el=$(this);var text=el.attr('placeholder');el.focus(function(){if(el.val()===text){el.val('').removeClass('placeholder_text');}}).blur(function(){FORMALIZE.misc.add_placeholder();});el.closest('form').submit(function(){if(el.val()===text){el.val('').removeClass('placeholder_text');}}).bind('reset',function(){setTimeout(FORMALIZE.misc.add_placeholder,50);});});}},misc:{add_placeholder:function(){if(PLACEHOLDER_SUPPORTED||!$(':input[placeholder]').length){return;}
$(':input[placeholder]').each(function(){if(this.type==='password'){return;}
var el=$(this);var text=el.attr('placeholder');if(!el.val()||el.val()===text){el.val(text).addClass('placeholder_text');}});}}};})(jQuery,this,this.document);jQuery(document).ready(function(){FORMALIZE.go();});
/*!
 * jQuery Tools v1.2.6 - The missing UI library for the Web
 * 
 * tooltip/tooltip.js
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 */
(function(a){a.tools=a.tools||{version:"v1.2.6"},a.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,c,d){b[a]=[c,d]}};var b={toggle:[function(a){var b=this.getConf(),c=this.getTip(),d=b.opacity;d<1&&c.css({opacity:d}),c.show(),a.call()},function(a){this.getTip().hide(),a.call()}],fade:[function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeTo(c.fadeInSpeed,c.opacity,b):(this.getTip().show(),b())},function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeOut(c.fadeOutSpeed,b):(this.getTip().hide(),b())}]};function c(b,c,d){var e=d.relative?b.position().top:b.offset().top,f=d.relative?b.position().left:b.offset().left,g=d.position[0];e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop());var h=c.outerHeight()+b.outerHeight();g=="center"&&(e+=h/2),g=="bottom"&&(e+=h),g=d.position[1];var i=c.outerWidth()+b.outerWidth();g=="center"&&(f-=i/2),g=="left"&&(f-=i);return{top:e,left:f}}
function d(d,e){var f=this,g=d.add(f),h,i=0,j=0,k=d.attr("title"),l=d.attr("data-tooltip"),m=b[e.effect],n,o=d.is(":input"),p=o&&d.is(":checkbox, :radio, select, :button, :submit"),q=d.attr("type"),r=e.events[q]||e.events[o?p?"widget":"input":"def"];if(!m)throw"Nonexistent effect \""+e.effect+"\"";r=r.split(/,\s*/);if(r.length!=2)throw"Tooltip: bad events configuration for "+q;d.bind(r[0],function(a){clearTimeout(i),e.predelay?j=setTimeout(function(){f.show(a)},e.predelay):f.show(a)}).bind(r[1],function(a){clearTimeout(j),e.delay?i=setTimeout(function(){f.hide(a)},e.delay):f.hide(a)}),k&&e.cancelDefault&&(d.removeAttr("title"),d.data("title",k)),a.extend(f,{show:function(b){if(!h){l?h=a(l):e.tip?h=a(e.tip).eq(0):k?h=a(e.layout).addClass(e.tipClass).appendTo(document.body).hide().append(k):(h=d.next(),h.length||(h=d.parent().next()));if(!h.length)throw"Cannot find tooltip for "+d}
if(f.isShown())return f;h.stop(!0,!0);var o=c(d,h,e);e.tip&&h.html(d.data("title")),b=a.Event(),b.type="onBeforeShow",g.trigger(b,[o]);if(b.isDefaultPrevented())return f;o=c(d,h,e),h.css({position:"absolute",top:o.top,left:o.left}),n=!0,m[0].call(f,function(){b.type="onShow",n="full",g.trigger(b)});var p=e.events.tooltip.split(/,\s*/);h.data("__set")||(h.unbind(p[0]).bind(p[0],function(){clearTimeout(i),clearTimeout(j)}),p[1]&&!d.is("input:not(:checkbox, :radio), textarea")&&h.unbind(p[1]).bind(p[1],function(a){a.relatedTarget!=d[0]&&d.trigger(r[1].split(" ")[0])}),e.tip||h.data("__set",!0));return f},hide:function(c){if(!h||!f.isShown())return f;c=a.Event(),c.type="onBeforeHide",g.trigger(c);if(!c.isDefaultPrevented()){n=!1,b[e.effect][1].call(f,function(){c.type="onHide",g.trigger(c)});return f}},isShown:function(a){return a?n=="full":n},getConf:function(){return e},getTip:function(){return h},getTrigger:function(){return d}}),a.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){b&&a(f).bind(c,b);return f}})}
a.fn.tooltip=function(b){var c=this.data("tooltip");if(c)return c;b=a.extend(!0,{},a.tools.tooltip.conf,b),typeof b.position=="string"&&(b.position=b.position.split(/,?\s/)),this.each(function(){c=new d(a(this),b),a(this).data("tooltip",c)});return b.api?c:this}})(jQuery);
$j(window).ready(function(){tooltip();if($j('.tooltip_trigger_rel').length){$j(".tooltip_trigger_rel").tooltip({position:"center top",effect:'toggle',direction:'right',delay:100,relative:true,offset:[0,0]})}
virtualGrid();$j('.qty-incr').click(function(){var val=$j(this).parent().children('.qty').val()*1;$j(this).parent().children('.qty').val(val+1);});$j('.qty-sub').click(function(){var val=$j(this).parent().children('.qty').val()*1;if(val>1){$j(this).parent().children('.qty').val(val-1);}});if($$('.home_contents .reviews h2.title')[0]!=undefined){$j($$('.top_message_bar li')[1]).click(function(){Effect.ScrollTo($$('.home_contents .reviews h2.title')[0]);})}});$j(window).load(function(){$j(".brands img").fadeIn(500);$j('.brands img').each(function(){var el=$j(this);var href=el.parent().attr('href');el.css({}).wrap("<a class='logo_grayscale' href='"+href+"' style='display: inline-block'>").clone().addClass('img_grayscale').css({"position":"absolute","z-index":"998","opacity":"0"}).insertBefore(el).queue(function(){var el=$j(this);el.parent().css({"width":this.width,"height":this.height});el.dequeue();});this.src=grayscale(this.src);});$j('.logo_grayscale img').mouseover(function(){$j(this).parent().find('img:first').stop().animate({opacity:1},700);});$j('.img_grayscale').mouseout(function(){$j(this).stop().animate({opacity:0},700);});$j(".cms_page_popup").fancybox({'titlePosition':'inside','transitionIn':'none','transitionOut':'none',});});function virtualGrid(){$j(".products-grid li").find(".item_det").hide().end().hover(function(){$j(this).find(".item_det").stop(true,true).fadeIn();},function(){$j(this).find(".item_det").stop(true,true).fadeOut();});}
function grayscale(src){var canvas=document.createElement('canvas');if(!canvas.getContext){return src;}
var ctx=canvas.getContext('2d');var imgObj=new Image();imgObj.src=src;canvas.width=imgObj.width;canvas.height=imgObj.height;ctx.drawImage(imgObj,0,0);var imgPixels=ctx.getImageData(0,0,canvas.width,canvas.height);for(var y=0;y<imgPixels.height;y++){for(var x=0;x<imgPixels.width;x++){var i=(y*4)*imgPixels.width+x*4;var avg=(imgPixels.data[i]+imgPixels.data[i+1]+imgPixels.data[i+2])/3;imgPixels.data[i]=avg;imgPixels.data[i+1]=avg;imgPixels.data[i+2]=avg;}}
ctx.putImageData(imgPixels,0,0,0,0,imgPixels.width,imgPixels.height);return canvas.toDataURL();}
function equalHeight(obj){var heightArray=obj.children("li").map(function(){return jQuery(this).height();}).get();var maxHeight=Math.max.apply(Math,heightArray);obj.children("li").height(maxHeight);}
jQuery.extend(jQuery.easing,{easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;}});$float_speed=1500;$float_easing="easeOutQuint";$menu_fade_speed=500;$closed_menu_opacity=0.75;var menuPosition=0;$j(window).load(function(){menuPosition=0;if($j("#fl_menu").length>0)
FloatMenu();});$j(window).scroll(function(){if($j("#fl_menu").length>0)
FloatMenu();});function FloatMenu(){var scrollAmount=$j(document).scrollTop();var checkAmount=scrollAmount;if($j("#fl_menu").height()>400){checkAmount=scrollAmount+$j("#fl_menu").height();}
var newPosition=menuPosition+scrollAmount;if($j(window).height()<$j("#fl_menu").height()){$j("#fl_menu").css("top",menuPosition);}
else if(checkAmount>($j(window).height())){var temp=scrollAmount-($j("#fl_menu").height()+25);if(temp<0){temp=0;}
$j("#fl_menu").stop().animate({top:temp},$float_speed,$float_easing);}
else{$j("#fl_menu").stop().animate({top:newPosition},$float_speed,$float_easing);}}
var ajaxAddToCart=function(url,productId){if(!url){url=$('product_addtocart_form').action;}
url=url.replace('/checkout/cart/add/','/checkout/cart/ajaxadd/');form=$('product_addtocart_form').serialize();gtmProductId=productId;new Ajax.Request(url,{method:'post',postBody:form,onLoading:function(){jQuery(".wrapper").mask("Please wait...");},onSuccess:function(transport){try{var response=transport.responseText.evalJSON();if(!response['error']){jQuery('#my_cart_msg').replaceWith(response['content']);jQuery.fancybox.close();if(Enterprise.TopCart!=undefined){Enterprise.TopCart.showCart(5);}else{new Effect.SlideDown('topCartContent',{duration:0.5});jQuery("#my_cart_msg .block-title").addClass('expanded');}}else if(response['content']){jQuery('.quick_add_error_message').html(response['content']);jQuery.fancybox.update();try{addToBasketClick(jQuery('#product_addtocart_form #qty').val());}catch(err){}}else{jQuery.fancybox.close();location.reload(true);}}catch(err){jQuery.fancybox.close();location.reload(true);}
jQuery(".wrapper").unmask();},onFailure:function(){jQuery(".wrapper").unmask();alert('Error while Adding product to basket')}});};var amazonPayButton;function updateCartItems(url,isDelete){if(!url){url=$('cartFrom').action;}
form=$('cartFrom').serialize();new Ajax.Request(url,{method:'post',postBody:form,onLoading:function(){if($('payButtonWidgetDiv')!=undefined){amazonPayButton=$('payButtonWidgetDiv');}
jQuery(".wrapper").mask("Loading...");},onSuccess:function(transport){var response=transport.responseText.evalJSON();jQuery('#cart_main_wrapper').replaceWith(response['content']);jQuery('#my_cart_msg').replaceWith(response['toplink']);if($('payButtonWidgetDiv')!=undefined&&amazonPayButton){$('payButtonWidgetDiv').update(amazonPayButton);}
if(isDelete){jQuery(".wrapper").unmask();}},onFailure:function(){jQuery(".wrapper").unmask();alert('Error while updating cart.')}});}
function checkQty(){var stockQty=parseInt(jQuery('#stockqty').val());var requestedQty=parseInt(jQuery('#qty').val());;if(stockQty<requestedQty){jQuery("#stock_popup").trigger('click');jQuery('#qty').val(stockQty);return false;}
return true;}
function open_section(section){if(section=='before_login'&&accordion.currentSection=='opc-billing'){checkout.accordion.openSection('opc-before_login');make_active_bar(section);return false;}
else if(section=='before_login'&&accordion.currentSection=='opc-shipping'){checkout.accordion.openSection('opc-before_login');make_active_bar(section);return false;}
else if(section=='before_login'&&accordion.currentSection=='opc-payment'){checkout.accordion.openSection('opc-before_login');make_active_bar(section);return false;}
else if(section=='billing'&&accordion.currentSection=='opc-shipping'){checkout.accordion.openSection('opc-billing');make_active_bar(section);return false;}
else if(section=='billing'&&accordion.currentSection=='opc-payment'){checkout.accordion.openSection('opc-billing');make_active_bar(section);return false;}
else if(section=='shipping'&&accordion.currentSection=='opc-payment'){checkout.accordion.openSection('opc-shipping');make_active_bar(section);return false;}}
function make_active_bar(section){entered=false;$$('.checkout_progress .checkout_progress_block').each(function(obj,index){$(obj).removeClassName('checkout_progress_allow');if('checkout_progress_opc_'+section==$(obj).id){entered=true;$(obj).addClassName('checkout_progress_active');}
else{if(!entered)
$(obj).addClassName('checkout_progress_allow');$(obj).removeClassName('checkout_progress_active');}});}
var dateE;Varien.AgeCheck=Class.create();Varien.AgeCheck.prototype={initialize:function(selector,required,format){var el=$$(selector)[0];var container={};container.day=Element.select(el,'.dob-day input')[0];container.month=Element.select(el,'.dob-month input')[0];container.year=Element.select(el,'.dob-year input')[0];container.full=Element.select(el,'.dob-full input')[0];container.advice=Element.select(el,'.validation-advice')[0];var mydate=new Date();dateE=new Varien.dateRangeDate('container',container,required,format);dateE.setDateRange(false,new Date('1/1/'+(mydate.getFullYear()-18)));}};jQuery('#copounForm .error-msg ul span').live('click',function(){location.reload();});jQuery(document).ready(function(){if($j('.cart-error-trigger').length>0){$j('.cart-error-trigger').fancybox({autoScale:true,maxWidth:720,});jQuery(".cart-error-trigger").trigger('click');jQuery('.fancybox-inner .cart-error-msg, .fancybox-inner .coupon-error').live('click',function(){jQuery.fancybox.close();});}});$j(window).load(function(){if(jQuery('.bar_blocks .overlay a').length>0){jQuery('.bar_blocks .overlay').click(function(){window.location.href=jQuery(this).children('a').attr('href');});}
jQuery('a.back_to_top, a.back_to_top_list').click(function(){jQuery("html, body").animate({scrollTop:0},1000);});jQuery('#cartFrom .qty.input-text').live('blur',function(){updateCartItems();});jQuery('#cartFrom .btn-remove2').live('click',function(){var url=jQuery(this).attr('href');url=url.replace('customDelete','ajaxDelete');updateCartItems(url,true);return false;});jQuery('.cloud-zoom-gallery').click(function(){if(jQuery('#zoom1 img').length){jQuery('#zoom1 img').attr('alt',jQuery(this).attr('title'));jQuery('#zoom1 img').attr('title',jQuery(this).attr('title'));}});});jQuery(document).ready(function(){mobileCategorySelect();manageProductQty();initHomePage();});var homeBannerSlider=function(opts){jQuery('.slickslider .slides').slick({lazyLoad:'ondemand',prevArrow:'<a href="javascript:void(0)" class="flex-prev single">Previous</a>',nextArrow:'<a class="flex-prev flex-next" href="javascript:void(0)">Next</a>',dots:true,dotsClass:'flex-control-nav',customPaging:function(slider,i){return jQuery('<a data-role="none" role="button" tabindex="0"></a>').text(i+1);},appendDots:jQuery('.slick-pager'),autoplay:true,autoplaySpeed:opts.timeout,speed:opts.speed});};var validateSearchBoxSearchParam=function(searchForm,placeHolder){jQuery('#search_trigger').click(function(){if(jQuery('#search').val()!=''&&jQuery('#search').val()!=placeHolder){searchForm.submit();}});};var mobileCategorySelect=function(){jQuery('.mobile_select').live('change',function(){var selectedVal=jQuery(this).val();if(selectedVal&&jQuery('#'+selectedVal).length>0){jQuery('#'+selectedVal).click();}});};var mobileFilters=function(){jQuery('#mobile_filter_title').click(function(){jQuery('#narrow-by-list2').toggle();});jQuery('.mobile_checkbox').click(function(){var filterCheckId=jQuery(this).attr('data-id');if(filterCheckId&&jQuery('#'+filterCheckId).length>0){jQuery('#'+filterCheckId).click();}});};var manageProductQty=function(){jQuery('#qty-add').click(function(){var val=jQuery('#qty').val()*1;jQuery('#qty').val(val+1);if(jQuery('.gift_box_qty').length>0){jQuery('.gift_box_qty').val(val+1);}});jQuery('#qty-sub').click(function(){var val=jQuery('#qty').val()*1;if(val>1){jQuery('#qty').val(val-1);if(jQuery('.gift_box_qty').length>0){jQuery('.gift_box_qty').val(val-1);}}});};var productShowMoreDescription=function(){jQuery("#full-descr").hide();jQuery('#more_details').click(function(){jQuery(this).hide();jQuery("#full-descr").show();});jQuery('#less_details').click(function(){jQuery("#full-descr").hide();jQuery('#more_details').show();});};var productTabsDisplay=function(){jQuery("#collateral-tabs .tab").on("click",function(){jQuery('.tab-content').css('visibility','visible');jQuery('.prod-page-tp-img-div').css('display','block');if(jQuery(".tab-container.active").length&&jQuery(".tab-container.active").html()!=jQuery(this).next().html()){jQuery(".tab-container.active .tab-content").slideToggle();jQuery(".tab-container.active").removeClass('active');}
jQuery(this).next().find(".tab-content").slideToggle();jQuery(this).next().toggleClass("active");jQuery(this).toggleClass("active");});jQuery('.tab-first').click();};var addGiftMessageContants=function(giftForm){jQuery('#add_gift_message').click(function(){if($('gift-message-whole-to').value=='Recipient`s Name')
$('gift-message-whole-to').value='';if($('gift-message-whole-from').value=='Your Name')
$('gift-message-whole-from').value='';if($('gift-message-whole-message').value=='Write your message')
$('gift-message-whole-message').value='';if(giftForm.validator.validate()){$('giftmessage_submit').submit();}});};var cartGiftMessageEvents=function(){jQuery('.toggle_arrow').live('click',function(){jQuery(this).hide();jQuery('.gift_cart_message').show();});jQuery('.gift_message_close').live('click',function(){jQuery('.toggle_arrow').show();jQuery('.gift_cart_message').hide();});jQuery('#gift-message-whole-message').live('keyup',function(){var maxLength=250;var charCount=jQuery('#charCount');if(jQuery(this).val().length>maxLength)jQuery(this).val(jQuery(this).val().substring(0,maxLength));if(charCount)charCount.html(maxLength-jQuery(this).val().length);});};var cartDeliveryEvents=function(){cartDeliveryEvents.called=true;jQuery('.radioAlt').live('click',function(){jQuery(this).parent().find('input').prop("checked",true).trigger('click');})
jQuery('.selected_day').live('click',function(){jQuery('.selected_day_content').show();jQuery(this).addClass('selected');jQuery('.select_delivery').removeClass('selected');jQuery('.select_delivery .input_1').prop("checked",true);jQuery('.select_delivery .input_1').parent().addClass('selected');updateShippingMethod();});jQuery('.selectDate button').live('click',function(){jQuery('#select_button').toggle();jQuery('.selectDate button').closest('.deliveryMethodOption').find('input').attr('checked',true);if(typeof isCheckout!='undefined'&&isCheckout){jQuery.fancybox.update();}});jQuery('#delivery_dates li').live('click',function(){jQuery("#matrixrate-del-date").val(jQuery(this).text());jQuery("#matrixrate-del-date").data('value',jQuery(this).data('value'));jQuery('#delivery_dates li').removeClass('selected');jQuery(this).addClass('selected');jQuery('#select_button').hide();updateShippingMethod();});};var updateShippingMethod=function(hideMask){var shippingMethod=jQuery("input[name=estimate_method]:checked").val();var deliveryCode=jQuery("input[name=estimate_method]:checked").attr('data-day');var deliveryDate=null;if(jQuery('#'+deliveryCode+'-del-date').length>0){deliveryDate=jQuery('#'+deliveryCode+'-del-date').data('value');}
if(typeof isBasket!='undefined'&&isBasket){if(!hideMask){jQuery(".wrapper").mask("Loading...");}
jQuery('#select_button').hide();jQuery("#ajaxTotalsTable").load(ajaxTableUrl,{shipping_method:shippingMethod,delivery_date:deliveryDate,delivery_type:deliveryCode},function(responseText){jQuery(".wrapper").unmask();});}else{jQuery('#shipping_delivery_date').val(deliveryDate);jQuery('#shipping_delivery_type').val(deliveryCode);if($$('input:checked[name="estimate_method"]')[0]!=undefined)
$$('input:checked[name="estimate_method"]')[0].triggerEvent('change');}
return true;};var cartItemQtyUpdate=function(){jQuery('.qnty-add').click(function(){var elem=jQuery(this).parent().find('.qty');var val=elem.val()*1;elem.val(val+1);updateCartItems();});jQuery('.qnty-sub').click(function(){var elem=jQuery(this).parent().find('.qty');var val=elem.val()*1;if(val>1){elem.val(val-1);updateCartItems();}});jQuery('#cartFrom .aboutproduct input.qty').change(function(){updateCartItems();});jQuery('#cartFrom .aboutproduct input.qty').keypress(function(e){if((e.which&&e.which==13)||(e.keyCode&&e.keyCode==13)){e.preventDefault();updateCartItems();}
return true;});};var initBrandInnerPage=function(){toggleBrandInfo();};var initHomePage=function(){if(jQuery('.cms-home').length){toggleBrandInfo();}};var initCategoryPages=function(){if(jQuery('.catalog-category-view').length){toggleBrandInfo();}}
var initCategoryPages=function(){if(jQuery('.catalog-category-view').length){toggleBrandInfo();}}
var toggleBrandInfo=function(){if(jQuery('.summary_content').length){var curHeight=jQuery("div.summary_content")[0].scrollHeight;var visibleHeight=90;if(jQuery('.visible_summary').length){visibleHeight=jQuery('.visible_summary').outerHeight(true);}
jQuery("div.summary_content").css({height:visibleHeight},200);jQuery("div.about_brand").toggle(function(){jQuery(this).toggleClass('active');jQuery("div.summary_content").animate({height:curHeight},200);},function(){jQuery(this).toggleClass('active');jQuery("div.summary_content").animate({height:visibleHeight},200);});}};var addGiftBoxProducts=function(){jQuery('.product-shop .qnt_add').click(function(){manageGiftBoxItems();});jQuery('.product-shop #qty').change(function(){manageGiftBoxItems();});};var manageGiftBoxItems=function(){var loading_ajax=SKIN_URL+'images/ajax-loader.gif';url=BASE_URL+'gift/index/updateProductGiftBox';var parentProductId=jQuery('#gift_parent_product').val();var bottleQty=jQuery('#qty').val();new Ajax.Request(url,{method:'post',postBody:'qty='+bottleQty+'&product_id='+parentProductId,onLoading:function(){jQuery('.product_gift_boxes').html('<div class="loading-ajax-small" style="text-align: center; width: 100%;"><img src="'+loading_ajax+'" alt="ajax loading"/></div>');},onSuccess:function(transport){var response=transport.responseText.evalJSON();jQuery('.product_gift_boxes').html(response['html']);}});};var calculateCartItemsHeight=function(){if(jQuery('.cart_item_wrapper').length>0){var listItems=jQuery("#mini-cart li");var height=10;jQuery('#topCartContent').css({position:'absolute',visibility:'hidden',display:'block'});var count=0;listItems.each(function(idx,li){if(count++>2){return;}
var item=jQuery(li);height=height+item.outerHeight();});jQuery('.cart_item_wrapper').css('height',height);jQuery('#topCartContent').attr("style",'display:none');}};var setLocationHref=function(url){window.location.href=url;};var updateFormKey=function(){if(jQuery('#fpc_formkey').length>0){var newFormKey=jQuery('#fpc_formkey').val();if(newFormKey&&sessionFormKey!=newFormKey){var action=jQuery('#product_addtocart_form').attr('action');action=action.replace('/form_key/'+sessionFormKey+'/','/form_key/'+newFormKey+'/');jQuery('#product_addtocart_form').attr('action',action);}}};var setEqualHeight=function(item){item.height('auto');var tallest=0;item.each(function(){var height=jQuery(this).height();if(height>tallest){tallest=height;}});item.height(tallest);};Validation.addAllThese([['validate-uk-mobile-number','This is required field',function(v){return!Validation.get('IsEmpty').test(v)&&/^0( ?\d){10}$/.test(v);}],['address-select','Please update your mobile number.',function(v,elm){try{if(v!=''){var optionText=elm[elm.selectedIndex].text;optionArray=optionText.split('|');var telephone=optionArray[optionArray.length-1];telephone=telephone.trim();if(!Validation.get('validate-uk-mobile-number').test(telephone)){elm.up('li').next('li').show();}else{elm.up('li').next('li').hide();elm.up('li').next('li').down('input').value='';}}else{elm.up('li').next('li').hide();elm.up('li').next('li').down('input').value='';}}catch(err){}
return true;}],['validate-confirm-email','Please make sure your emails match.',function(v){var conf=$('email-confirm')?$('email-confirm'):$$('.validate-confirm-email')[0];var email=false;if($('login-email2')){email=$('login-email2');}
return(email.value==conf.value);}],]);
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,n="https:"==document.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";o||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E"))),t()}(function(){var t,o="mCustomScrollbar",a="mCS",n=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if("off"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),"once"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var n=o.data(a),i=n.opt,l=o.data("mcs-axis"),s=o.data("mcs-scrollbar-position"),c=o.data("mcs-theme");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),n&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),e("#mCSB_"+n.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container"),l=e("#mCSB_"+n.idx),s=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];if(!r.length)return;n.tweenRunning&&Q(t),o&&n&&i.callbacks.onBeforeUpdate&&"function"==typeof i.callbacks.onBeforeUpdate&&i.callbacks.onBeforeUpdate.call(this),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),l.css("max-height","none"),l.height()!==t.height()&&l.css("max-height",t.height()),_.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",x(r)),n.overflowed=y.call(this),M.call(this),i.autoDraggerLength&&S.call(this),b.call(this),T.call(this);var c=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(n.overflowed[0]?s[0].height()>s[0].parent().height()?B.call(this):(G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}),n.contentReset.y=null):(B.call(this),"y"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[1]&&G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(n.overflowed[1]?s[1].width()>s[1].parent().width()?B.call(this):(G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}),n.contentReset.x=null):(B.call(this),"x"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[0]&&G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,o){if("undefined"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=ne()?0:d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&i.overflowed[0]&&(s.dir="y",s.overwrite="all",G(n,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&i.overflowed[1]&&(s.dir="x",s.overwrite="none",G(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&Q(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){o.data(a);N.call(this,"remove"),k.call(this),t&&B.call(this),M.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx),s=e("#mCSB_"+i.idx+"_container"),c=e(".mCSB_"+i.idx+"_scrollbar");r.live&&m(r.liveSelector||e(t).selector),N.call(this,"remove"),k.call(this),B.call(this),n.removeData(a),$(this,"mcs"),c.remove(),s.find("img."+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+" _"+a+"_"+i.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},f=function(){return"object"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),$(l,e))},p=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},g=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+n.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+n.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===i.axis?l[0]+l[1]:"x"===i.axis?l[1]:l[0],u="yx"===i.axis?"<div id='mCSB_"+n.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",f=i.autoHideScrollbar?" "+d[6]:"",h="x"!==i.axis&&"rtl"===n.langDir?" "+d[7]:"";i.setWidth&&t.css("width",i.setWidth),i.setHeight&&t.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===n.langDir?"989999px":i.setLeft,t.addClass(o+" _"+a+"_"+n.idx+f+h).wrapInner("<div id='mCSB_"+n.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+s+"'><div id='mCSB_"+n.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir='"+n.langDir+"' /></div>");var m=e("#mCSB_"+n.idx),p=e("#mCSB_"+n.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css("width",x(p)),"outside"===i.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(u)),w.call(this);var g=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},x=function(t){var o=[t[0].scrollWidth,Math.max.apply(Math,t.children().map(function(){return e(this).outerWidth(!0)}).get())],a=t.parent().width();return o[0]>a?o[0]:o[1]>a?o[1]:"100%"},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx+"_container");if(n.advanced.autoExpandHorizontalScroll&&"y"!==n.axis){i.css({width:"auto","min-width":0,"overflow-x":"scroll"});var r=Math.ceil(i[0].scrollWidth);3===n.advanced.autoExpandHorizontalScroll||2!==n.advanced.autoExpandHorizontalScroll&&r>i.parent().width()?i.css({width:r,"min-width":"100%","overflow-x":"inherit"}):i.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(".mCSB_"+o.idx+"_scrollbar:first"),r=oe(n.scrollButtons.tabindex)?"tabindex='"+n.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+d[13]+"' "+r+" />","<a href='#' class='"+d[14]+"' "+r+" />","<a href='#' class='"+d[15]+"' "+r+" />","<a href='#' class='"+d[16]+"' "+r+" />"],s=["x"===n.axis?l[2]:l[0],"x"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},b=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},C=function(e,t,o){var a=o?d[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(d[0]+" "+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},y=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1),s=i[0].scrollHeight,c=i[0].scrollWidth;return s>r&&(r=s),c>l&&(l=c),[r>n.height(),l>n.width()]},B=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx),r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(Q(t),("x"!==n.axis&&!o.overflowed[0]||"y"===n.axis&&o.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==n.axis&&!o.overflowed[1]||"x"===n.axis&&o.overflowed[1]){var s=dx=0;"rtl"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},T=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(I.call(this),i.contentTouchScroll&&D.call(this),E.call(this),i.mouseWheel.enable){var r;t()}P.call(this),U.call(this),i.advanced.autoScrollOnFocus&&H.call(this),i.scrollButtons.enable&&F.call(this),i.keyboard.enable&&q.call(this),n.bindEvents=!0}},k=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",l=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),n.advanced.extraDraggableSelectors&&l.add(e(n.advanced.extraDraggableSelectors)),o.bindEvents&&(e(document).add(e(!A()||top.document)).unbind("."+i),l.each(function(){e(this).unbind("."+i)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(s[0].onCompleteTimeout),$(s[0],"onCompleteTimeout"),o.bindEvents=!1)},M=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+n.idx+"_container"),s=[e("#mCSB_"+n.idx+"_scrollbar_vertical"),e("#mCSB_"+n.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(d[8]+" "+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(d[10])):(s[0].css("display","none"),l.addClass(d[10])),l.addClass(d[8]))),"y"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(d[9]+" "+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(d[11])):(s[1].css("display","none"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},O=function(t){var o=t.type,a=t.target.ownerDocument!==document&&null!==frameElement?[e(frameElement).offset().top,e(frameElement).offset().left]:null,n=A()&&t.target.ownerDocument!==top.document&&null!==frameElement?[e(t.view.frameElement).offset().top,e(t.view.frameElement).offset().left]:[0,0];switch(o){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return a?[t.originalEvent.pageY-a[0]+n[0],t.originalEvent.pageX-a[1]+n[1],!1]:[t.originalEvent.pageY,t.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],r=t.originalEvent.touches.length||t.originalEvent.changedTouches.length;return t.target.ownerDocument!==document?[i.screenY,i.screenX,r>1]:[i.pageY,i.pageX,r>1];default:return a?[t.pageY-a[0]+n[0],t.pageX-a[1]+n[1],!1]:[t.pageY,t.pageX,!1]}},I=function(){function t(e,t,a,n){if(h[0].idleTimer=d.scrollInertia<233?250:0,o.attr("id")===f[1])var i="x",s=(o[0].offsetLeft-t+n)*l.scrollRatio.x;else var i="y",s=(o[0].offsetTop-e+a)*l.scrollRatio.y;G(r,s.toString(),{dir:i,drag:!0})}var o,n,i,r=e(this),l=r.data(a),d=l.opt,u=a+"_"+l.idx,f=["mCSB_"+l.idx+"_dragger_vertical","mCSB_"+l.idx+"_dragger_horizontal"],h=e("#mCSB_"+l.idx+"_container"),m=e("#"+f[0]+",#"+f[1]),p=d.advanced.releaseDraggableSelectors?m.add(e(d.advanced.releaseDraggableSelectors)):m,g=d.advanced.extraDraggableSelectors?e(!A()||top.document).add(e(d.advanced.extraDraggableSelectors)):e(!A()||top.document);m.bind("contextmenu."+u,function(e){e.preventDefault()}).bind("mousedown."+u+" touchstart."+u+" pointerdown."+u+" MSPointerDown."+u,function(t){if(t.stopImmediatePropagation(),t.preventDefault(),ee(t)){c=!0,s&&(document.onselectstart=function(){return!1}),L.call(h,!1),Q(r),o=e(this);var a=o.offset(),l=O(t)[0]-a.top,u=O(t)[1]-a.left,f=o.height()+a.top,m=o.width()+a.left;f>l&&l>0&&m>u&&u>0&&(n=l,i=u),C(o,"active",d.autoExpandScrollbar)}}).bind("touchmove."+u,function(e){e.stopImmediatePropagation(),e.preventDefault();var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;t(n,i,r,l)}),e(document).add(g).bind("mousemove."+u+" pointermove."+u+" MSPointerMove."+u,function(e){if(o){var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;if(n===r&&i===l)return;t(n,i,r,l)}}).add(p).bind("mouseup."+u+" touchend."+u+" pointerup."+u+" MSPointerUp."+u,function(){o&&(C(o,"active",d.autoExpandScrollbar),o=null),c=!1,s&&(document.onselectstart=null),L.call(h,!0)})},D=function(){function o(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,b=0,C=0,d=1,y.removeClass("mCS_touch_action");var o=I.offset();u=O(e)[0]-o.top,f=O(e)[1]-o.left,z=[O(e)[0],O(e)[1]]}function n(e){if(te(e)&&!c&&!O(e)[2]&&(T.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!C||b)&&d)){g=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left,n="mcsLinearOut";if(E.push(o),W.push(a),z[2]=Math.abs(O(e)[0]-z[0]),z[3]=Math.abs(O(e)[1]-z[1]),B.overflowed[0])var i=D[0].parent().height()-D[0].height(),r=u-o>0&&o-u>-(i*B.scrollRatio.y)&&(2*z[3]<z[2]||"yx"===T.axis);if(B.overflowed[1])var l=D[1].parent().width()-D[1].width(),h=f-a>0&&a-f>-(l*B.scrollRatio.x)&&(2*z[2]<z[3]||"yx"===T.axis);r||h?(U||e.preventDefault(),b=1):(C=1,y.addClass("mCS_touch_action")),U&&e.preventDefault(),w="yx"===T.axis?[u-o,f-a]:"x"===T.axis?[null,f-a]:[u-o,null],I[0].idleTimer=250,B.overflowed[0]&&s(w[0],R,n,"y","all",!0),B.overflowed[1]&&s(w[1],R,n,"x",L,!0)}}function i(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),Q(y),p=K();var o=M.offset();h=O(e)[0]-o.top,m=O(e)[1]-o.left,E=[],W=[]}function r(e){if(te(e)&&!c&&!O(e)[2]){d=0,e.stopImmediatePropagation(),b=0,C=0,v=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left;if(!(v-g>30)){_=1e3/(v-p);var n="mcsEaseOut",i=2.5>_,r=i?[E[E.length-2],W[W.length-2]]:[0,0];x=i?[o-r[0],a-r[1]]:[o-h,a-m];var u=[Math.abs(x[0]),Math.abs(x[1])];_=i?[Math.abs(x[0]/4),Math.abs(x[1]/4)]:[_,_];var f=[Math.abs(I[0].offsetTop)-x[0]*l(u[0]/_[0],_[0]),Math.abs(I[0].offsetLeft)-x[1]*l(u[1]/_[1],_[1])];w="yx"===T.axis?[f[0],f[1]]:"x"===T.axis?[null,f[1]]:[f[0],null],S=[4*u[0]+T.scrollInertia,4*u[1]+T.scrollInertia];var y=parseInt(T.contentTouchScroll)||0;w[0]=u[0]>y?w[0]:0,w[1]=u[1]>y?w[1]:0,B.overflowed[0]&&s(w[0],S[0],n,"y",L,!1),B.overflowed[1]&&s(w[1],S[1],n,"x",L,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&G(y,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C,y=e(this),B=y.data(a),T=B.opt,k=a+"_"+B.idx,M=e("#mCSB_"+B.idx),I=e("#mCSB_"+B.idx+"_container"),D=[e("#mCSB_"+B.idx+"_dragger_vertical"),e("#mCSB_"+B.idx+"_dragger_horizontal")],E=[],W=[],R=0,L="yx"===T.axis?"none":"all",z=[],P=I.find("iframe"),H=["touchstart."+k+" pointerdown."+k+" MSPointerDown."+k,"touchmove."+k+" pointermove."+k+" MSPointerMove."+k,"touchend."+k+" pointerup."+k+" MSPointerUp."+k],U=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;I.bind(H[0],function(e){o(e)}).bind(H[1],function(e){n(e)}),M.bind(H[0],function(e){i(e)}).bind(H[2],function(e){r(e)}),P.length&&P.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(H[0],function(e){o(e),i(e)}).bind(H[1],function(e){n(e)}).bind(H[2],function(e){r(e)})})})},E=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?"stepped":"stepless",d.scrollAmount=10,j(r,e,t,"mcsLinearOut",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+"_"+l.idx,f=e("#mCSB_"+l.idx+"_container"),h=f.parent();f.bind("mousedown."+u,function(){t||i||(i=1,c=!0)}).add(document).bind("mousemove."+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=O(e)[0]-a.top+f[0].offsetTop,c=O(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n("off",null,"stepped"):("x"!==s.axis&&l.overflowed[0]&&(0>r?n("on",38):r>h.height()&&n("on",40)),"y"!==s.axis&&l.overflowed[1]&&(0>c?n("on",37):c>h.width()&&n("on",39)))}}).bind("mouseup."+u+" dragend."+u,function(){t||(i&&(i=0,n("off",null)),c=!1)})},W=function(){function t(t,a){if(Q(o),!z(o,t.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100,d=i.scrollInertia;if("x"===i.axis||"x"===i.mouseWheel.axis)var u="x",f=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.width()?.9*l.width():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetLeft),p=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v="y"===i.mouseWheel.axis?t.deltaY||a:t.deltaX;else var u="y",f=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.height()?.9*l.height():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetTop),p=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=t.deltaY||a;"y"===u&&!n.overflowed[0]||"x"===u&&!n.overflowed[1]||((i.mouseWheel.invert||t.webkitDirectionInvertedFromDevice)&&(v=-v),i.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==p||0>v&&p!==g||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),t.deltaFactor<5&&!i.mouseWheel.normalizeDelta&&(h=t.deltaFactor,d=17),G(o,(m-v*h).toString(),{dir:u,dur:d}))}}if(e(this).data(a)){var o=e(this),n=o.data(a),i=n.opt,r=a+"_"+n.idx,l=e("#mCSB_"+n.idx),c=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")],d=e("#mCSB_"+n.idx+"_container").find("iframe");d.length&&d.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,o){t(e,o)})})}),l.bind("mousewheel."+r,function(e,o){t(e,o)})}},R=new Object,A=function(t){var o=!1,a=!1,n=null;if(void 0===t?a="#empty":void 0!==e(t).attr("id")&&(a=e(t).attr("id")),a!==!1&&void 0!==R[a])return R[a];if(t){try{var i=t.contentDocument||t.contentWindow.document;n=i.body.innerHTML}catch(r){}o=null!==n}else{try{var i=top.document;n=i.body.innerHTML}catch(r){}o=null!==n}return a!==!1&&(R[a]=o),o},L=function(e){var t=this.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}},z=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(":focus"))},P=function(){var t,o=e(this),n=o.data(a),i=a+"_"+n.idx,r=e("#mCSB_"+n.idx+"_container"),l=r.parent(),s=e(".mCSB_"+n.idx+"_scrollbar ."+d[12]);s.bind("mousedown."+i+" touchstart."+i+" pointerdown."+i+" MSPointerDown."+i,function(o){c=!0,e(o.target).hasClass("mCSB_dragger")||(t=1)}).bind("touchend."+i+" pointerup."+i+" MSPointerUp."+i,function(){c=!1}).bind("click."+i,function(a){if(t&&(t=0,e(a.target).hasClass(d[12])||e(a.target).hasClass("mCSB_draggerRail"))){Q(o);var i=e(this),s=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!n.overflowed[1])return;var c="x",u=a.pageX>s.offset().left?-1:1,f=Math.abs(r[0].offsetLeft)-u*(.9*l.width())}else{if(!n.overflowed[0])return;var c="y",u=a.pageY>s.offset().top?-1:1,f=Math.abs(r[0].offsetTop)-u*(.9*l.height())}G(o,f.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),l=r.parent();r.bind("focusin."+i,function(){var o=e(document.activeElement),a=r.find(".mCustomScrollBox").length,i=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=a?(i+17)*a:0,t[0]._focusTimeout=setTimeout(function(){var e=[ae(o)[0],ae(o)[1]],a=[r[0].offsetTop,r[0].offsetLeft],s=[a[0]+e[0]>=0&&a[0]+e[0]<l.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<l.width()-o.outerWidth(!1)],c="yx"!==n.axis||s[0]||s[1]?"all":"none";"x"===n.axis||s[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i}),"y"===n.axis||s[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i})},t[0]._focusTimer))})},U=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container").parent();i.bind("scroll."+n,function(){0===i.scrollTop()&&0===i.scrollLeft()||e(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e(l+">a");s.bind("contextmenu."+r,function(e){e.preventDefault()}).bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,o){i.scrollAmount=n.scrollButtons.scrollAmount,j(t,e,o)}if(a.preventDefault(),ee(a)){var l=e(this).attr("class");switch(i.type=n.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;c=!0,o.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;c=!1,i.dir&&r("off",l);break;case"click":if("stepped"!==i.type||o.tweenRunning)return;r("on",l)}}})},q=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.keyboard.scrollAmount,"stepped"===r.type&&n.tweenRunning||j(o,e,t)}switch(t.type){case"blur":n.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var l=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===l||40===l)||"y"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;"keyup"===t.type&&(s="off"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type){Q(o);var f=34===l?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=Math.abs(c[0].offsetLeft)-f*(.9*d.width());else var h="y",m=Math.abs(c[0].offsetTop)-f*(.9*d.height());G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type)){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h="y",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+"_"+n.idx,s=e("#mCSB_"+n.idx),c=e("#mCSB_"+n.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",f=c.find("iframe"),h=["blur."+l+" keydown."+l+" keyup."+l];f.length&&f.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr("tabindex","0").bind(h[0],function(e){t(e)})},j=function(t,o,n,i,r){function l(e){u.snapAmount&&(f.scrollAmount=u.snapAmount instanceof Array?"x"===f.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var o="stepped"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],m="x"===f.dir[0]?s[1]+f.dir[1]*(d[1]*n):s[0]+f.dir[1]*(d[0]*n),v="x"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),x="auto"!==f.scrollAmount?v:m,_=i?i:e?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",w=!!e;return e&&17>a&&(x="x"===f.dir[0]?s[1]:s[0]),G(t,x.toString(),{dir:f.dir[0],scrollEasing:_,dur:a,onComplete:w}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),$(f,"step"),Q(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===f.type,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case"on":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?"x":"y",n===d[13]||n===d[15]||38===n||37===n?-1:1],Q(t),oe(n)&&"stepped"===f.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return"function"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:"x"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||"x"===o.axis?null:t,n[1]=t.x?t.x:t.y||"y"===o.axis?null:t),"function"==typeof n[0]&&(n[0]=n[0]()),"function"==typeof n[1]&&(n[1]=n[1]()),n},X=function(t,o){if(null!=t&&"undefined"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx+"_container"),s=l.parent(),c=typeof t;o||(o="x"===r.axis?"x":"y");var d="x"===o?l.outerWidth(!1)-s.width():l.outerHeight(!1)-s.height(),f="x"===o?l[0].offsetLeft:l[0].offsetTop,h="x"===o?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===o?ae(m)[1]:ae(m)[0];case"string":case"number":if(oe(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(f-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=f+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&oe(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===o?ae(m)[1]:ae(m)[0]}return e(t).length?"x"===o?ae(e(t))[1]:ae(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},N=function(t){function o(){return clearTimeout(f[0].autoUpdate),0===l.parents("html").length?void(l=null):void(f[0].autoUpdate=setTimeout(function(){return c.advanced.updateOnSelectorChange&&(s.poll.change.n=i(),s.poll.change.n!==s.poll.change.o)?(s.poll.change.o=s.poll.change.n,void r(3)):c.advanced.updateOnContentResize&&(s.poll.size.n=l[0].scrollHeight+l[0].scrollWidth+f[0].offsetHeight+l[0].offsetHeight+l[0].offsetWidth,s.poll.size.n!==s.poll.size.o)?(s.poll.size.o=s.poll.size.n,void r(1)):!c.advanced.updateOnImageLoad||"auto"===c.advanced.updateOnImageLoad&&"y"===c.axis||(s.poll.img.n=f.find("img").length,s.poll.img.n===s.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&o()):(s.poll.img.o=s.poll.img.n,void f.find("img").each(function(){n(this)}))},c.advanced.autoUpdateTimeout))}function n(t){function o(e,t){return function(){return t.apply(e,arguments)}}function a(){this.onload=null,e(t).addClass(d[2]),r(2)}if(e(t).hasClass(d[2]))return void r();var n=new Image;n.onload=o(n,a),n.src=t.src}function i(){c.advanced.updateOnSelectorChange===!0&&(c.advanced.updateOnSelectorChange="*");var e=0,t=f.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&t.length>0&&t.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function r(e){clearTimeout(f[0].autoUpdate),u.update.call(null,l[0],e)}var l=e(this),s=l.data(a),c=s.opt,f=e("#mCSB_"+s.idx+"_container");return t?(clearTimeout(f[0].autoUpdate),void $(f[0],"autoUpdate")):void o()},V=function(e,t,o){return Math.round(e/t)*t-o},Q=function(t){var o=t.data(a),n=e("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");n.each(function(){Z.call(this)})},G=function(t,o,n){function i(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||w>=S[0]+y,c.callbacks.alwaysTriggerOffsets||-B>=w]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[x[0].offsetTop,x[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=n.trigger,0===m.scrollTop()&&0===m.scrollLeft()||(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==o||s.contentReset.y||(i("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==o||s.contentReset.x||(i("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){if(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?"x"===n.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;o=V(o,v,c.snapOffset)}switch(n.dir){case"x":var x=e("#mCSB_"+s.idx+"_dragger_horizontal"),_="left",w=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),x.parent().width()-x.width()],b=[o,0===o?0:o/s.scrollRatio.x],y=p[1],B=g[1],T=y>0?y/s.scrollRatio.x:0,k=B>0?B/s.scrollRatio.x:0;break;case"y":var x=e("#mCSB_"+s.idx+"_dragger_vertical"),_="top",w=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),x.parent().height()-x.height()],b=[o,0===o?0:o/s.scrollRatio.y],y=p[0],B=g[0],T=y>0?y/s.scrollRatio.y:0,k=B>0?B/s.scrollRatio.y:0}b[1]<0||0===b[0]&&0===b[1]?b=[0,0]:b[1]>=S[1]?b=[S[0],S[1]]:b[0]=-b[0],t[0].mcs||(l(),i("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),J(x[0],_,Math.round(b[1]),u[1],n.scrollEasing),!s.tweenRunning&&(0===w&&b[0]>=0||w===S[0]&&b[0]<=S[0])||J(h[0],_,Math.round(b[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,C(x),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),i("onTotalScroll")&&b[1]>=S[1]-T&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i("onTotalScrollBack")&&b[1]<=k&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,C(x,"hide")},e)}}})}},J=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=K()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+"px"):w[t]=o+"px",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=K(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];"left"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,"none"!==i&&d(),c()},K=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},$=function(e,t){try{delete e[t]}catch(o){e[t]=null}},ee=function(e){return!(e.which&&1!==e.which)},te=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},oe=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ae=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},ne=function(){function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}var t=e();return t?document[t]:!1};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).bind("load",function(){e(n)[o](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(".mCSB_container");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+ae(n)[0]>=0&&a[0]+ae(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+ae(n)[1]>=0&&a[1]+ae(n)[1]<o.width()-n.outerWidth(!1)},mcsInSight:e.expr[":"].mcsInSight||function(t,o,a){var n,i,r,l,s=e(t),c=s.parents(".mCSB_container"),d="exact"===a[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(c.length)return n=[s.outerHeight(!1),s.outerWidth(!1)],r=[c[0].offsetTop+ae(s)[0],c[0].offsetLeft+ae(s)[1]],i=[c.parent()[0].offsetHeight,c.parent()[0].offsetWidth],l=[n[0]<i[0]?d[0]:d[1],n[1]<i[1]?d[0]:d[1]],r[0]-i[0]*l[0][0]<0&&r[0]+n[0]-i[0]*l[0][1]>=0&&r[1]-i[1]*l[1][0]<0&&r[1]+n[1]-i[1]*l[1][1]>=0},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});
;Mana.define('Mana/LayeredNavigation/TopBlock',['jquery','Mana/Core/Block'],function($,Block,undefined)
{return Block.extend('Mana/LayeredNavigation/TopBlock',{_init:function(){this._super();this._expandCollapseStates={};this._accordionExpandedId=undefined;this._mobileLayout=false;this._subTitleExpanded=false;this._replacedTitles=[];},_subscribeToHtmlEvents:function(){var self=this;function _expandCollapse(e){self.expandCollapse(this,e);}
function _expandCollapseSubTitle(){self.expandCollapseSubTitle(this);}
function _mouseEnter(){self.$().addClass('m-over');}
function _mouseLeave(){self.$().removeClass('m-over');}
return this._super().on('bind',this,function(){this._replacedTitles=[];if(!this.$().hasClass("one-filter-column")){this._prepareWideLayout();}
this.$().find('dl dt.m-ln').on('click',_expandCollapse);this.$().find('.block-subtitle').on('click',_expandCollapseSubTitle);this.$().find('.block-subtitle, .actions').on('mouseenter',_mouseEnter);this.$().find('.block-subtitle, .actions').on('mouseleave',_mouseLeave);}).on('unbind',this,function(){this.$().find('dl dt.m-ln').off('click',_expandCollapse);this.$().find('.block-subtitle').off('click',_expandCollapseSubTitle);this.$().find('.block-subtitle, .actions').off('mouseenter',_mouseEnter);this.$().find('.block-subtitle, .actions').off('mouseleave',_mouseLeave);});},_subscribeToBlockEvents:function(){return this._super().on('resize',this,this.resize);},resize:function(){var self=this;var widthClassFound=false;var wasOneColumn=this.$().hasClass("one-filter-column");$.each(this.getWidths(),function(cls,width){var contentWidth=cls=="one-filter-column"?$('body').width():self.$().width();if(width&&!widthClassFound&&contentWidth<width){self.$().addClass(cls);widthClassFound=true;}
else{self.$().removeClass(cls);}});var isOneColumn=this.$().hasClass("one-filter-column");if(wasOneColumn&&!isOneColumn){this._prepareWideLayout();}
else if(isOneColumn&&!wasOneColumn){this._prepareMobileLayout();}},expandCollapse:function(dt,e){if(this._mobileLayout&&!$(e.target).parents('.m-filterclear').length){var id=$(dt).data('id');switch(this.getBehavior()){case'initially-collapsed':if(this._expandCollapseStates[id]){this._expandCollapseStates[id]=false;this.collapse(dt,this.getDuration());}
else{this._expandCollapseStates[id]=true;this.expand(dt,this.getDuration());}
break;case'initially-expanded':if(this._expandCollapseStates[id]){this._expandCollapseStates[id]=false;this.expand(dt,this.getDuration());}
else{this._expandCollapseStates[id]=true;this.collapse(dt,this.getDuration());}
break;case'accordion':default:if(this._accordionExpandedId!=id){this.collapse(this.$().find('dl dt.m-ln[data-id="'+this._accordionExpandedId+'"]'),this.getDuration());this.expand(dt,this.getDuration());this._accordionExpandedId=id;}
else if(this._accordionExpandedId!==''){this.collapse(this.$().find('dl dt.m-ln[data-id="'+this._accordionExpandedId+'"]'),this.getDuration());this._accordionExpandedId='';}
break;}}},expandCollapseSubTitle:function(){if(this._mobileLayout){if(this._subTitleExpanded){this._subTitleExpanded=false;this.collapseSubTitle(this.getDuration());}
else{this._subTitleExpanded=true;this.expandSubTitle(this.getDuration());}}},_prepareMobileLayout:function(){this._mobileLayout=true;this.$().removeClass('m-wide');if(this.getHideSidebars()){$(this.getSidebarLayeredNavSelector()).hide();}
var $filters=this.$().find('dl dt.m-ln');var self=this;this._replacedTitles=[];this.$().find('.block-subtitle').each(function(){var $text=$(this).find('span');self._replacedTitles.push({element:this,title:$(this).html(),hidden:$(this).hasClass('hidden')});$(this).removeClass('hidden');$text.html(self.getMobileTitle());});$filters.each(function(){self._prepareFilterForMobileLayout(this);});switch(this.getBehavior()){case'initially-collapsed':this._prepareMobileLayoutByDefaultCollapsed();break;case'initially-expanded':this._prepareMobileLayoutByDefaultExpanded();break;case'accordion':default:this._prepareMobileLayoutAsAccordion();break;}
if(this._subTitleExpanded){this.expandSubTitle(0);}
else{this.collapseSubTitle(0);}},_prepareMobileLayoutByDefaultExpanded:function(){var $filters=this.$().find('dl dt.m-ln');var self=this;$filters.each(function(){if(self._expandCollapseStates[$(this).data('id')]){self.collapse(this,0);}
else{self.expand(this,0);}});},_prepareMobileLayoutByDefaultCollapsed:function(){var $filters=this.$().find('dl dt.m-ln');var self=this;$filters.each(function(){if(self._expandCollapseStates[$(this).data('id')]){self.expand(this,0);}
else{self.collapse(this,0);}});},_prepareWideLayout:function(){this._mobileLayout=false;this.$().addClass('m-wide');if(this.getHideSidebars()){$(this.getSidebarLayeredNavSelector()).show();}
var $filters=this.$().find('dl dt.m-ln');var self=this;$.each(this._replacedTitles,function(index,replacement){var $element=$(replacement.element);var $text=$element.find('span');$text.html(replacement.title);if(replacement.hidden){$element.addClass('hidden');}});this._replacedTitles=[];$filters.each(function(){self._prepareFilterForWideLayout(this);self.expand(this,0);});this.expandSubTitle(0);},_prepareMobileLayoutAsAccordion:function(){var $filters=this.$().find('dl dt.m-ln');var self=this;var firstFilterId='';var found=false;$filters.each(function(){var id=$(this).data('id');if(!firstFilterId){firstFilterId=id;}
if(self._accordionExpandedId==id){found=true;return false;}
else{return true;}});if(!found&&self._accordionExpandedId!==''){self._accordionExpandedId=firstFilterId;}
$filters.each(function(){if(self._accordionExpandedId==$(this).data('id')){self.expand(this,0);}
else{self.collapse(this,0);}});},getBehavior:function(){if(this._behavior===undefined){this._behavior=this.$().data('behavior');}
return this._behavior;},getDuration:function(){if(this._duration===undefined){this._duration=this.$().data('duration');if(this._duration===''){this._duration=500;}}
return this._duration;},getMobileTitle:function(){if(this._mobileTitle===undefined){this._mobileTitle=this.$().data('title');}
return this._mobileTitle;},getHideSidebars:function(){if(this._hideColumnFilters===undefined){this._hideColumnFilters=this.$().data('hide-sidebars');}
return this._hideColumnFilters;},getSidebarLayeredNavSelector:function(){return'.col-left .block.block-layered-nav,'+'.mb-mana-catalog-leftnav,'+'.col-right .block.block-layered-nav,'+'.mb-mana-catalog-rightnav';},getWidths:function(){throw'Abstract';},_prepareFilterForWideLayout:function(dt){var $dd=$(dt).next();$dd.trigger('m-prepare');},_prepareFilterForMobileLayout:function(dt){var $dd=$(dt).next();$dd.trigger('m-prepare');},expand:function(element,duration){$(element).removeClass('m-collapsed').addClass('m-expanded');$(element).next().trigger('m-prepare');$(element).next().slideDown(duration);},collapse:function(element,duration){$(element).removeClass('m-expanded').addClass('m-collapsed');$(element).next().slideUp(duration);},expandSubTitle:function(duration){var self=this;this.$().removeClass('m-collapsed').addClass('m-expanded');this.$().find('.block-subtitle').removeClass('m-collapsed').addClass('m-expanded');this.$().find('dl dt.m-ln').each(function(){$(this).next().trigger('m-prepare');});$('.m-shop-by').next().slideDown(duration);},collapseSubTitle:function(duration){this.$().removeClass('m-expanded').addClass('m-collapsed');this.$().find('.block-subtitle').removeClass('m-expanded').addClass('m-collapsed');$('.m-shop-by').next().slideUp(duration);}});});Mana.define('Mana/LayeredNavigation/Top/MenuBlock',['jquery','Mana/LayeredNavigation/TopBlock'],function($,TopBlock,undefined)
{return TopBlock.extend('Mana/LayeredNavigation/Top/MenuBlock',{_prepareFilterForWideLayout:function(dt){var $dl=$(dt).parent();if($dl.hasClass('m-removed-inline')){$dl.addClass('m-inline').removeClass('m-removed-inline');}
if(!$dl.hasClass('m-inline')){$(dt).next().addClass('hidden');}
this._super();},_prepareFilterForMobileLayout:function(dt){var $dl=$(dt).parent();if($dl.hasClass('m-inline')){$dl.addClass('m-removed-inline').removeClass('m-inline');}
$(dt).next().removeClass('hidden').width('auto');this._super();},getWidths:function(){if(this._widths===undefined){this._widths={"one-filter-column":this.$().data('one-column')};}
return this._widths;},_calculatePopupWidth:function($dt,$dd){var minWidth=this.getMinWidth();var maxWidth=this.getMaxWidth();var result=$dd.width()>$dt.width()?$dd.width():$dt.width();result=maxWidth?(result<=maxWidth?result:maxWidth):result;result=minWidth?(result>=minWidth?result:minWidth):result;return result;},_subscribeToHtmlEvents:function(){var self=this;function _mouseEnterFilter(){self._mouseEnterFilter($(this).parent(),$(this),$(this).next());}
function _mouseLeaveFilter(){self._mouseLeaveFilter($(this).parent(),$(this),$(this).next());}
function _mouseEnterOptions(){self._mouseEnterOptions($(this).parent(),$(this).prev(),$(this));}
function _mouseLeaveOptions(){self._mouseLeaveOptions($(this).parent(),$(this).prev(),$(this));}
return this._super().on('bind',this,function(){this.$().find('dl dt.m-ln').on('mouseenter',_mouseEnterFilter);this.$().find('dl dt.m-ln').on('mouseleave',_mouseLeaveFilter);this.$().find('dl dd.m-ln').on('mouseenter',_mouseEnterOptions);this.$().find('dl dd.m-ln').on('mouseleave',_mouseLeaveOptions);}).on('unbind',this,function(){this.$().find('dl dt.m-ln').off('mouseenter',_mouseEnterFilter);this.$().find('dl dt.m-ln').off('mouseleave',_mouseLeaveFilter);this.$().find('dl dd.m-ln').off('mouseenter',_mouseEnterOptions);this.$().find('dl dd.m-ln').off('mouseleave',_mouseLeaveOptions);});},_mouseEnterFilter:function($dl,$dt,$dd){if($dl.hasClass('m-inline')||this._mobileLayout){return true;}
$dd.removeClass('hidden').offset({top:$dt.offset().top+$dt.outerHeight(),left:$dt.offset().left}).width(this._calculatePopupWidth($dt,$dd)).addClass('m-popup-filter');$dt.addClass('m-popup-filter');$dd.trigger('m-prepare');return true;},_mouseLeaveFilter:function($dl,$dt,$dd){if($dl.hasClass('m-inline')||this._mobileLayout){return true;}
$dd.removeClass('m-popup-filter').addClass('hidden');$dt.removeClass('m-popup-filter');return true;},_mouseEnterOptions:function($dl,$dt,$dd){if($dl.hasClass('m-inline')||this._mobileLayout){return true;}
$dd.removeClass('hidden').offset({top:$dt.offset().top+$dt.outerHeight(),left:$dt.offset().left}).width(this._calculatePopupWidth($dt,$dd)).addClass('m-popup-filter');$dt.addClass('m-popup-filter');return true;},_mouseLeaveOptions:function($dl,$dt,$dd){if($dl.hasClass('m-inline')||this._mobileLayout){return true;}
$dd.removeClass('m-popup-filter').addClass('hidden');$dt.removeClass('m-popup-filter');return true;},getMinWidth:function(){if(this._minWidth===undefined){this._minWidth=this.$().data('min-width');}
return this._minWidth;},getMaxWidth:function(){if(this._maxWidth===undefined){this._maxWidth=this.$().data('max-width');}
return this._maxWidth;}});});Mana.define('Mana/LayeredNavigation/Top/HorizontalBlock',['jquery','Mana/LayeredNavigation/TopBlock'],function($,TopBlock,undefined)
{return TopBlock.extend('Mana/LayeredNavigation/Top/HorizontalBlock',{_init:function(){this._super();this._minHeights={};},_prepareFilterForWideLayout:function(dt){var minHeight;if(minHeight=this._minHeights[$(dt).data('id')]){$(dt).parent().css('min-height',minHeight);}
this._super();},_prepareFilterForMobileLayout:function(dt){var minHeight;if(minHeight=$(dt).parent().css('min-height')){this._minHeights[$(dt).data('id')]=minHeight;$(dt).parent().css('min-height','');}
this._super();},getWidths:function(){if(this._widths===undefined){this._widths={"one-filter-column":this.$().data('one-column'),"two-filter-columns":this.$().data('two-columns'),"three-filter-columns":this.$().data('three-columns'),"four-filter-columns":this.$().data('four-columns')};}
return this._widths;}});});
;Mana.define('Mana/LayeredNavigation/AjaxInterceptor',['jquery','singleton:Mana/Core/Ajax','singleton:Mana/Core/Config','singleton:Mana/Core/Layout'],function($,ajax,config,layout,undefined)
{return Mana.Object.extend('Mana/LayeredNavigation/AjaxInterceptor',{_getBaseUrl:function(url){return config.getBaseUrl(url);},_isProductListToolbarClicked:function(element){return element!==undefined&&($(element).parents().hasClass('mb-category-products')||$(element).parents().hasClass('mb-cms-products')||$(element).parents().hasClass('mb-search-result'));},match:function(url,element){if(element){var ajaxContainerSelector=config.getData('layeredNavigation.ajax.containers');if(ajaxContainerSelector){if(!$(ajaxContainerSelector).has(element).length){return false;}}}
var result=false;var exception=false;if(url==location.href+'#'){return result;}
var decodedUrl=decodeURIComponent(url);var pattern=config.getData('layeredNavigation.ajax.exceptionPatterns');if(pattern){pattern=new RegExp(pattern);if(pattern.test(decodedUrl)){return result;}}
$.each(config.getData('layeredNavigation.ajax.exceptions'),function(key,exceptionUrl){if(url.indexOf(exceptionUrl)!=0){return true;}
var suffixPos=false;if(config.getData('url.suffix')){suffixPos=url.indexOf(config.getData('url.suffix'),exceptionUrl.length);if(suffixPos===-1){return true;}}
exception=true;return false;});if(exception){return result;}
$.each(config.getData('url.unfiltered'),function(key,unfilteredUrl){if(url.indexOf(unfilteredUrl)!=0){return true;}
var suffixPos=false;if(config.getData('url.suffix')){suffixPos=url.indexOf(config.getData('url.suffix'),unfilteredUrl.length);if(suffixPos===-1){return true;}}
result=true;return false;});return result;},intercept:function(url,element){var isProductListToolbarClicked=this._isProductListToolbarClicked(element);var parser=document.createElement('a');parser.href=url;if(window._gaq!==undefined){window._gaq.push(['_setAccount',config.getData('ga.account')]);window._gaq.push(['_trackPageview',url.substring(parser.protocol.length+parser.hostname.length+2)]);}
if(window.ga!==undefined){window.ga('send','pageview',{'page':url.substring(parser.protocol.length+parser.hostname.length+2)});}
var encodedUrl=url;url=decodeURIComponent(url);var encodedQueryPos=encodedUrl.indexOf('?'),queryPos=url.indexOf('?');if(encodedQueryPos!=-1&&queryPos!=-1){url=url.substr(0,queryPos)+'?'+encodedUrl.substr(encodedQueryPos+1);}
url=this._getBaseUrl(url)+config.getData('layeredNavigation.ajax.urlKey')+'/'+config.getData('ajax.currentRoute')+'/'+config.getData('layeredNavigation.ajax.routeSeparator')+'/'+
url.substr(this._getBaseUrl(url).length);ajax.get(url,function(response){ajax.update(response);layout.getPageBlock().resize();if($('#nav')&&typeof mainNav!='undefined'){mainNav("nav",{"show_delay":"100","hide_delay":"100"});}
if(isProductListToolbarClicked&&config.getData('layeredNavigation.ajax.scrollToTop')){var offset=-1;$.each(response.blocks,function(blockName){var block=layout.getBlock(blockName);if(block){var blockOffset=block.$().offset().top;if(offset==-1||offset>=blockOffset){offset=blockOffset;}}});if(offset>=0){offset-=10;if(offset<0){offset=0;}
scroll(0,offset);}}},{preventClicks:true,encode:queryPos!=-1?{offset:0,length:queryPos}:undefined});}});});Mana.require(['jquery','singleton:Mana/Core/Ajax','singleton:Mana/LayeredNavigation/AjaxInterceptor'],function($,ajax,layeredNavigationAjaxInterceptor)
{ajax.addInterceptor(layeredNavigationAjaxInterceptor);});
;(function($){$('.m-filter-colors .m-color, .state.m-color').live('mouseover',function(){$(this).addClass('hovered');});$('.m-filter-colors .m-color, .state.m-color').live('mouseout',function(){$(this).removeClass('hovered');});})(jQuery);
;(function($,undefined){var _states={};function expand(element,duration){$(element).removeClass('m-collapsed').addClass('m-expanded');$(element).next().slideDown(duration);}
function collapse(element,duration){$(element).removeClass('m-expanded').addClass('m-collapsed');$(element).next().slideUp(duration);}
function saveState(element){if($(element).hasClass('m-expanded')){_states[$(element).attr('data-id')]=true;expand(element,0);}
else if($(element).hasClass('m-collapsed')){_states[$(element).attr('data-id')]=false;collapse(element,0);}
else if($(element).attr('data-collapsed')=='collapsed'){_states[$(element).attr('data-id')]=false;collapse(element,0);}
else{_states[$(element).attr('data-id')]=true;expand(element,0);}}
function restoreState(element){if(_states[$(element).attr('data-id')]!==undefined){if(_states[$(element).attr('data-id')]){expand(element,0);}
else{collapse(element,0);}}
else{saveState(element);}}
$(function(){$('.block-layered-nav .m-collapseable').each(function(index,element){saveState(element);});});$(document).bind('m-ajax-after',function(e,selectors){$('.block-layered-nav .m-collapseable').each(function(index,element){restoreState(element);});});$('.block-layered-nav .m-collapseable, .block-layered-nav-mob .m-collapseable').live('click',function(){var element=this;if($(element).hasClass('m-expanded')){_states[$(element).attr('data-id')]=false;collapse(element,200);}
else{_states[$(element).attr('data-id')]=true;expand(element,200);}});})(jQuery);(function($){var _selectors={visibleDd:'.block-layered-nav dl dd.m-dropdown-menu.m-popup-filter',dt:'.block-layered-nav dl dt.m-dropdown-menu',dd:'.block-layered-nav dl dd.m-dropdown-menu'};function _width(dt,dd){var maxWidth=dd.attr('data-max-width');var result=dd.width()>dt.width()?dd.width():dt.width();return maxWidth?(result<=maxWidth?result:maxWidth):result;}
function _hidePopups(){var $popups=$(_selectors.visibleDd);if($popups.length){$popups.each(function(){var dd=$(this);var dt=$(this).prev();dd.removeClass('m-popup-filter').addClass('hidden');dt.removeClass('m-popup-filter');});return true;}
else{return false;}}
$(_selectors.dt).live('click',function(){if(!_hidePopups()){var dt=$(this);var dd=$(this).next();if(dd.hasClass('hidden')){dd.removeClass('hidden').offset({top:dt.offset().top+dt.outerHeight(),left:dt.offset().left}).width(_width(dt,dd)).addClass('m-popup-filter');dt.addClass('m-popup-filter');}
return false;}});$(document).click(function(){_hidePopups();});$(function(){$(_selectors.dd).addClass('hidden');});$(document).bind('m-ajax-after',function(){$(_selectors.dd).addClass('hidden');});})(jQuery);
;(function($,undefined){var _states={};function expand(element,duration){$(element).removeClass('m-collapsed').addClass('m-expanded');$(element).next().slideDown(duration);}
function collapse(element,duration){$(element).removeClass('m-expanded').addClass('m-collapsed');$(element).next().slideUp(duration);}
function saveState(element){if($(element).hasClass('m-expanded')){_states[$(element).attr('data-id')]=true;expand(element,0);}
else if($(element).hasClass('m-collapsed')){_states[$(element).attr('data-id')]=false;collapse(element,0);}
else if($(element).attr('data-collapsed')=='collapsed'){_states[$(element).attr('data-id')]=false;collapse(element,0);}
else{_states[$(element).attr('data-id')]=true;expand(element,0);}}
function restoreState(element){if(_states[$(element).attr('data-id')]!==undefined){if(_states[$(element).attr('data-id')]){expand(element,0);}
else{collapse(element,0);}}
else{saveState(element);}}
$(function(){$('.block-layered-nav .m-collapseable-group').each(function(index,element){saveState(element);});});$(document).bind('m-ajax-after',function(e,selectors){$('.block-layered-nav .m-collapseable-group').each(function(index,element){restoreState(element);});});$('.block-layered-nav .m-collapseable-group').live('click',function(){var element=this;if($(element).hasClass('m-expanded')){_states[$(element).attr('data-id')]=false;collapse(element,200);}
else{_states[$(element).attr('data-id')]=true;expand(element,200);}});})(jQuery);
;(function($){$(function(){$('.m-help .m-text').hide();$('.m-help').live('mouseover',function(){$(this).find('.m-text').show();}).live('mouseout',function(){$(this).find('.m-text').hide();});});$(document).bind('m-ajax-after',function(e,selectors){$('.m-help .m-text').hide();});})(jQuery);
;Mana.define('Mana/LayeredNavigation/ShowMore/PopupAction',['jquery','Mana/Core/Block','singleton:Mana/Core/UrlTemplate','singleton:Mana/Core/Json','singleton:Mana/Core/Ajax','singleton:Mana/Core/Layout','singleton:Mana/Core'],function($,Block,urlTemplate,json,ajax,layout,core,undefined)
{return Block.extend('Mana/LayeredNavigation/ShowMore/PopupAction',{_subscribeToHtmlEvents:function(){var self=this;function _openPopup(){self._openPopup();return false;}
return this._super().on('bind',this,function(){this.$().find('a.m-show-more-popup-action').on('click',_openPopup);}).on('unbind',this,function(){this.$().find('a.m-show-more-popup-action').off('click',_openPopup);});},getPopupUrl:function(){return decodeURIComponent(urlTemplate.decodeAttribute(this.$().data('popup-url')));},getTargetUrl:function(){if(this._targetUrl===undefined){this._targetUrl=urlTemplate.decodeAttribute(this.$().data('target-url'));}
return this._targetUrl;},getClearUrl:function(){if(this._clearUrl===undefined){this._clearUrl=urlTemplate.decodeAttribute(this.$().data('clear-url'));}
return this._clearUrl;},getSelectedItems:function(){return json.decodeAttribute(this.$().data('selected-items'));},getPopupBlockName:function(){if(this._popupBlockName===undefined){this._popupBlockName=this.$().data('popup-block');}
return this._popupBlockName;},getSeparator:function(){if(this._separator===undefined){this._separator=this.$().data('separator');}
return this._separator;},getColumnCount:function(){return this.$().data('column-count');},getRowCount:function(){return this.$().data('row-count');},rearrangeItems:function($popup){var self=this;var $unorganizedColumns=$popup.find('.m-columns');var $items=$popup.find('.m-columns li');var columnClass=$unorganizedColumns.attr('class');var horizontalColors=$unorganizedColumns.hasClass('m-filter-colors')&&$unorganizedColumns.hasClass('horizontal');var $rows=$popup.find('.m-rows');var $rowsToBeRemoved=$rows.children('li');if($items.length){var scrollBarWidth=30,reservedMargin=20;var popupWidth=$(window).width()-($popup.outerWidth()-$rows.outerWidth())
-scrollBarWidth-reservedMargin;var popupHeight=$(window).height()-($popup.outerHeight()-$rows.outerHeight())-reservedMargin;var columnWidth=horizontalColors?$unorganizedColumns.outerWidth():$items.first().outerWidth();var columnCount=Math.floor(popupWidth/columnWidth);var height=0;if(columnCount<1){columnCount=1;if(horizontalColors){columnWidth=popupWidth-(columnWidth-$unorganizedColumns.width());columnWidth=Math.floor(columnWidth/$items.first().outerWidth())*$items.first().outerWidth()+4;$unorganizedColumns.width(columnWidth);}
else{$items.width(popupWidth-(columnWidth-$items.first().width()));}}
if(columnCount>self.getColumnCount()){columnCount=self.getColumnCount();}
if(horizontalColors){var scrollHeight,rowIndex=0,top,rowTop;$items.each(function(){var $item=$(this);if(top===undefined){rowTop=top=$item.position().top;}
else if(top<$item.position().top){rowIndex++;top=$item.position().top;}
height=top-rowTop+$item.outerHeight();if(scrollHeight===undefined&&(height>popupHeight||rowIndex+1>=self.getRowCount())){scrollHeight=top-rowTop;}});if(scrollHeight!==undefined){$rows.attr('data-max-height',scrollHeight);}}
else{var $columns,$row,scrollRows,$hiddenRow,index=0;$items.each(function(){var item=this,$item=$(item),visible=!$item.hasClass('m-no-match');if(visible){var columnIndex=index%columnCount;var rowIndex=Math.floor(index/columnCount);if(columnIndex===0){$row=$('<li><ol class="'+columnClass+'"></ol></li>');$rows.append($row);}
$columns=$row.children().first();$columns.append(item);if(columnIndex==columnCount-1){height+=$row.outerHeight();if(scrollRows===undefined&&(height>popupHeight||rowIndex+1>=self.getRowCount())){scrollRows=rowIndex;}}
index++;}
else{if(!$hiddenRow){$hiddenRow=$('<li><ol class="'+columnClass+'"></ol></li>').hide();$rows.append($hiddenRow);}
$columns=$hiddenRow.children().first();$columns.append(item);}});if(scrollRows!==undefined){$rows.attr('data-max-rows',scrollRows);}
$rowsToBeRemoved.remove();}}},_openPopup:function(){var self=this;var url=this.getPopupUrl().replace('__0__',urlTemplate.encodeAttribute(location.href));ajax.get(url,function(response){var options={content:response,overlay:{opacity:0.2},popup:{'class':'m-showmore-popup-container',blockName:self.getPopupBlockName()},popupBlock:{host:self},fadein:{overlayTime:0,popupTime:300,callback:function(popupBlock){self._popupBlock=popupBlock;}},fadeout:{overlayTime:0,popupTime:500,callback:null}};var $popup=layout.preparePopup(options);$popup.show();self.rearrangeItems($popup);$popup.hide();layout.showPopup(options);});},close:function(){layout.hidePopup();},apply:function(items){layout.hidePopup();if(core.count(items)){var sortedItems=[];$.each(items,function(index,value){sortedItems.push(value);});sortedItems.sort(function(a,b){if(a.position<b.position)return-1;if(a.position>b.position)return 1;if(parseInt(a.id)<parseInt(b.id))return-1;if(parseInt(a.id)>parseInt(b.id))return 1;if(a.index<b.index)return-1;if(a.index>b.index)return 1;return 0;});if(sortedItems.length==1&&sortedItems[0].full_url){setLocation(sortedItems[0].full_url);}
else{var param='';var prefix='';var separator=this.getSeparator();$.each(sortedItems,function(index,value){if(value.prefix){prefix=value.prefix;}
if(param){param+=separator;}
param+=value.url;});setLocation(this.getTargetUrl().replace('__0__',prefix+param));}}
else{setLocation(this.getClearUrl());}}});});Mana.define('Mana/LayeredNavigation/Popup',['jquery','Mana/Core/Block','singleton:Mana/Core/Json'],function($,Block,json){return Block.extend('Mana/LayeredNavigation/Popup',{prepare:function(options){var self=this;this._host=options.host;this._selectedItems=this._host.getSelectedItems();this.$().find('.m-rows').each(function(){var rows=$(this);var maxRowCount,maxRowHeight;var height=0;if(maxRowCount=rows.attr('data-max-rows')){rows.children().each(function(index){if(index<maxRowCount){height+=$(this).outerHeight();}});rows.width(rows.width()+30).height(height).addClass('m-scrollable-filter');}
else if(maxRowHeight=rows.attr('data-max-height')){rows.height(maxRowHeight).addClass('m-scrollable-filter');}});this.$().find('button.m-close').on('click',function(){return self._close();});this.$().find('button.m-apply').on('click',function(){return self._apply();});},rearrangeItems:function(){return this._host.rearrangeItems(this.$());},_close:function(){this._host.close();return false;},_apply:function(){this._host.apply(this._selectedItems);return false;},_toggleItem:function(element,isSelected){var $element=$(element);if($element.data('is-reverse')){isSelected=!isSelected;}
var itemData=json.decodeAttribute($element.data('item'));if(itemData){itemData.index=$element.data('index');if(isSelected){this._selectedItems[itemData.url]=itemData;}
else{delete this._selectedItems[itemData.url];}}
return false;},_setItem:function(element){var $element=$(element);var itemData=json.decodeAttribute($element.data('item'));itemData.index=$element.data('index');var key=itemData.url;this._selectedItems={key:itemData};return false;}});});Mana.define('Mana/LayeredNavigation/Popup/CssCheckbox',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/CssCheckbox',{prepare:function(options){this._super(options);var self=this;this.$().find('a.m-checkbox-checked, a.m-checkbox-unchecked').on('click',function(){return self._toggle(this);});},_toggle:function(element){var $element=$(element);$element.parent().toggleClass('m-selected-ln-item');$element.toggleClass('m-checkbox-checked').toggleClass('m-checkbox-unchecked');return this._toggleItem(element,$element.parent().hasClass('m-selected-ln-item'));}});});Mana.define('Mana/LayeredNavigation/Popup/Checkbox',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/Checkbox',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > input').on('click',function(){return self._toggle(this);});},_toggle:function(element){var $element=$(element);$element.parent().toggleClass('m-selected-ln-item');this._toggleItem(element,$element.parent().hasClass('m-selected-ln-item'));}});});Mana.define('Mana/LayeredNavigation/Popup/Standard',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/Standard',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > a').on('click',function(){return self._toggle(this);});},_toggle:function(element){this._setItem(element);return this._apply();}});});Mana.define('Mana/LayeredNavigation/Popup/ColorOne',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/ColorOne',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > a').on('click',function(){return self._toggle(this);});},_toggle:function(element){this._setItem(element);return this._apply();}});});Mana.define('Mana/LayeredNavigation/Popup/List',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/List',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > a').on('click',function(){return self._toggle(this);});},_toggle:function(element){var $element=$(element);$element.parent().toggleClass('m-selected-ln-item');$element.children().toggleClass('m-selected-filter-item');return this._toggleItem(element,$element.parent().hasClass('m-selected-ln-item'));}});});Mana.define('Mana/LayeredNavigation/Popup/Color',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/Color',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > a').on('click',function(){return self._toggle(this);});},_toggle:function(element){var $element=$(element);$element.parent().toggleClass('m-selected-ln-item');$element.find('div').toggleClass('selected');return this._toggleItem(element,$element.parent().hasClass('m-selected-ln-item'));}});});Mana.define('Mana/LayeredNavigation/Popup/ColorWithLabel',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/ColorWithLabel',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > a').on('click',function(){return self._toggle(this);});},_toggle:function(element){var $element=$(element);$element.parent().toggleClass('m-selected-ln-item');$element.find('div').toggleClass('selected');return this._toggleItem(element,$element.parent().hasClass('m-selected-ln-item'));}});});Mana.define('Mana/LayeredNavigation/Popup/Radio',['jquery','Mana/LayeredNavigation/Popup'],function($,Popup){return Popup.extend('Mana/LayeredNavigation/Popup/Radio',{prepare:function(options){this._super(options);var self=this;this.$().find('ol.m-columns > li > input').on('click',function(){return self._toggle(this);});},_toggle:function(element){this._setItem(element);this._apply();}});});Mana.define('Mana/LayeredNavigation/OptionSearch',['jquery','Mana/Core/Block'],function($,Block,undefined){return Block.extend('Mana/LayeredNavigation/OptionSearch',{_subscribeToHtmlEvents:function(){var self=this;function _search(){self._search();}
function _focus(){self._focus();}
function _blur(){self._blur();}
return this._super().on('bind',this,function(){this.$input().on('focus',_focus);this.$input().on('blur',_blur);this.$input().on('keyup',_search);this.$input().on('change',_search);if(this._needle!==undefined){this.$input().val(this._needle);this._focus();this._blur();this._search();}}).on('unbind',this,function(){this.$input().off('focus',_focus);this.$input().off('blur',_blur);this.$input().off('keyup',_search);this.$input().off('change',_search);});},$input:function(){return this.$().find('input');},$list:function(){return this.$().parent().children(':not(.m-option-search)').first();},$items:function(){return this.$list().children();},_search:function(){var needle;if(this.$input().val()!=this.$input().attr("title")){needle=this.$input().val().toLowerCase();var $list=this.$list();this.$items().each(function(){var $item=$(this);var haystack=$list.is('.m-filter-colors.vertical,.m-columns.m-filter-colors.horizontal')?$item.find('a > div').attr('title'):($list.is('.m-filter-colors.horizontal')?$item.children('div').attr('title'):$item.text());haystack=haystack.toLowerCase();if(haystack.indexOf(needle)!=-1){$item.removeClass('m-no-match');}
else{$item.addClass('m-no-match');}});}
else{needle='';this.$items().removeClass('m-no-match');}
this._needle=needle;this._afterSearch();},_afterSearch:function(){this.$().parent().trigger('m-prepare');},_focus:function(){var $input=this.$input();if($input.val()==$input.attr("title")){$input.val("");}
$input.removeClass('m-empty');},_blur:function(){var $input=this.$input();if($input.val()==""){$input.val($input.attr("title")).addClass('m-empty');}
else{$input.removeClass('m-empty');}}});});Mana.define('Mana/LayeredNavigation/OptionSearch/Popup',['jquery','Mana/LayeredNavigation/OptionSearch'],function($,OptionSearch){return OptionSearch.extend('Mana/LayeredNavigation/OptionSearch/Popup',{$list:function(){return this.$().parent().children(':not(.m-option-search)').first().find('.m-columns');},_afterSearch:function(){this._super();this.getParent().rearrangeItems();}});});(function($,undefined){var prefix='m-more-less-';var _inAjax=false;var _states={};var _itemCounts={};var _time={};function _calculateHeights(l,code){if(l.is('.m-filter-colors.horizontal')){return _calculateHorizontalColorHeights(l,code);}
else{return _calculateOtherHeights(l,code);}}
function _calculateOtherHeights(l,code){var visible=l.is(':visible');var hiddenElement=l;var hiddenDisplayStyle;if(!visible){while(hiddenElement.parent().length&&!hiddenElement.parent().is(':visible')){hiddenElement=hiddenElement.parent();}
hiddenDisplayStyle=hiddenElement.length?hiddenElement[0].style.display:undefined;hiddenElement.show();}
var heights={less:0,more:0,count:0};l.children(':not(.m-no-match)').each(function(index,item){if(index<_itemCounts[code]||!l.hasClass('m-reverse')&&$(item).hasClass('m-selected-ln-item')||l.hasClass('m-reverse')&&!$(item).hasClass('m-selected-ln-item')){heights.less+=$(item).outerHeight(true);}
heights.more+=$(item).outerHeight(true);heights.count++;});if(!visible&&hiddenElement.length){hiddenElement[0].style.display=hiddenDisplayStyle;}
return heights;}
function _calculateHorizontalColorHeights(l,code){var visible=l.is(':visible');var hiddenElement=l;if(!visible){while(hiddenElement.parent().length&&!hiddenElement.parent().is(':visible')){hiddenElement=hiddenElement.parent();}
hiddenElement.show();}
var heights={less:0,more:0,count:0},firstTop;l.children(':not(.m-no-match)').each(function(index,item){var $item=$(item).children().first();if(firstTop===undefined){firstTop=$item.position().top;}
var bottom=$item.position().top-firstTop+$item.outerHeight(true);if(index<_itemCounts[code]||!l.hasClass('m-reverse')&&$(item).hasClass('m-selected-ln-item')||l.hasClass('m-reverse')&&!$(item).hasClass('m-selected-ln-item')){heights.less=bottom;}
heights.more=bottom;heights.count++;});if(!visible){hiddenElement.hide();}
return heights;}
function apply(code,withTransition){var div=$('#'+prefix+code);var l=div.parent().children(':not(.m-option-search)').first();var heights;heights=_calculateHeights(l,code);if(heights.count<=_itemCounts[code]){l.removeClass('m-expandable-filter');div.hide();if(withTransition){l.animate({height:heights.more+'px'},_time[code]);}
else{l.height(heights.more);}}
else{l.addClass('m-expandable-filter');div.show();if(_states[code]){if(withTransition){l.animate({height:heights.more+'px'},_time[code]);}
else{l.height(heights.more);}
div.find('.m-show-less-action').show();div.find('.m-show-more-action').hide();}
else{if(withTransition){l.animate({height:heights.less+'px'},_time[code]);}
else{l.height(heights.less);}
div.find('.m-show-less-action').hide();div.find('.m-show-more-action').show();}}}
function getFilterCode(el){var code=$(el).parent()[0].id;if(!code.match("^"+prefix)==prefix){throw'Unexpected show more/show less id';}
return code.substring(prefix.length);}
function clickHandler(){var code=getFilterCode(this);_states[code]=!_states[code];apply(code,true);return false;}
$(document).bind('m-show-more-reset',function(e,code,itemCount,showAll,time){var div=$('#'+prefix+code);if(!_inAjax){_states[code]=showAll;}
_itemCounts[code]=itemCount;_time[code]=time;apply(code,false);div.parent().on('m-prepare',function(){apply(code,false);});});function _initFilterScrollBar(l,code){var heights=_calculateHeights(l,code);if(heights.count>_itemCounts[code]){l.addClass('m-scrollable-filter');l.parent().addClass('m-scrollable-filter-container');l.height(heights.less);}
else{l.removeClass('m-scrollable-filter');l.parent().removeClass('m-scrollable-filter-container');l.height('auto');}}
$(document).bind('m-filter-scroll-reset',function(e,code,itemCount){_itemCounts[code]=itemCount;var div=$('#'+prefix+code);var l=div.parent().children(':not(.m-option-search)').first();_initFilterScrollBar(l,code);l.parent().on('m-prepare',function(){_initFilterScrollBar(l,code);});});$(document).bind('m-ajax-before',function(e,selectors){_inAjax=true;});$(document).bind('m-ajax-after',function(e,selectors){for(var code in _states){apply(code,false);}
_inAjax=false;});$('a.m-show-less-action').live('click',clickHandler);$('a.m-show-more-action').live('click',clickHandler);})(jQuery);
if(!Control)var Control={};Control.PriceSlider=Class.create();Control.PriceSlider.prototype={initialize:function(handle,track,options){var slider=this;if(handle instanceof Array){this.handles=handle.collect(function(e){return $(e)});}else{this.handles=[$(handle)];}
this.track=$(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1');this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(s){return $(s)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0');this.alignY=parseInt(this.options.alignY||'0');this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?this.handles[0].offsetHeight:this.handles[0].offsetWidth;this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled)this.setDisabled();this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}
this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((slider.options.sliderValue instanceof Array?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);Element.makePositioned(h);Event.observe(h,"mousedown",slider.eventMouseDown);Event.observe(h,"touchstart",slider.eventMouseDown);});Event.observe(this.track,"mousedown",this.eventMouseDown);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(this.track,"touchstart",this.eventMouseDown);Event.observe(document,"touchend",this.eventMouseUp);Event.observe(document,"touchmove",this.eventMouseMove);this.initialized=true;},dispose:function(){var slider=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(this.track,"touchstart",this.eventMouseDown);Event.stopObserving(document,"touchend",this.eventMouseUp);Event.stopObserving(document,"touchmove",this.eventMouseMove);this.handles.each(function(h){Event.stopObserving(h,"mousedown",slider.eventMouseDown);Event.stopObserving(h,"touchstart",slider.eventMouseDown);});},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){if(value>=this.allowedValues.max())return(this.allowedValues.max());if(value<=this.allowedValues.min())return(this.allowedValues.min());var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];this.allowedValues.each(function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end)return this.range.end;if(value<this.range.start)return this.range.start;return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandle=this.handles[handleIdx];this.activeHandleIdx=handleIdx;this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1]))
sliderValue=this.values[handleIdx-1];if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1]))
sliderValue=this.values[handleIdx+1];}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue,handleIdx);this.drawSpans();if(!this.dragging||!this.event)this.updateFinished();},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value,handleIdx){if(this.handles.length==2){if(handleIdx!=null){var offset=(value-this.range.start)/(this.range.end-this.range.start)*(this.trackLength-2*this.handleLength);if(handleIdx>0){return Math.round(offset+this.handleLength)+'px';}
else{return Math.round(offset)+'px';}}
else{var offset=(value-this.range.start)/(this.range.end-this.range.start)*(this.trackLength-2*this.handleLength);return Math.round(offset+this.handleLength)+'px';}}
else{return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";}},translateToValue:function(offset){var percent=0;if(this.handles.length==2){if(this.activeHandleIdx>0){percent=(offset-1.5*this.handleLength)/(this.trackLength-2*this.handleLength)}
else{percent=(offset+0.5*this.handleLength)/(this.trackLength-2*this.handleLength)}
var value=percent*(this.range.end-this.range.start)+this.range.start;if(value<this.range.start){value=this.range.start;}
else if(value>this.range.end){value=this.range.end;}
return value;}
else{return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);}},getRange:function(range){var v=this.values.sortBy(Prototype.K);range=range||0;return $R(v[range],v[range+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?this.track.offsetHeight-this.alignY:this.track.offsetWidth-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans)
$R(0,this.spans.length-1).each(function(r){slider.setSpan(slider.spans[r],slider.getRange(r))});if(this.options.startSpan)
this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));if(this.options.endSpan)
this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start,null);span.style.height=this.translateToPx(range.end-range.start+this.range.start,null);}else{span.style.left=this.translateToPx(range.start,null);span.style.width=this.translateToPx(range.end-range.start+this.range.start,null);}},updateStyles:function(){this.handles.each(function(h){Element.removeClassName(h,'selected')});Element.addClassName(this.activeHandle,'selected');},startDrag:function(event){if(Event.isLeftClick(event)||(Prototype.Browser.IE&&document.documentMode>=9&&event.buttons==1)||event.touches){if(!this.disabled){this.active=true;var handle=Event.element(event);var pointer=(event.touches?[event.touches[0].clientX,event.touches[0].clientY]:[Event.pointerX(event),Event.pointerY(event)]);if(handle==this.track){this.active=false;}else{while((this.handles.indexOf(handle)==-1)&&handle.parentNode)
handle=handle.parentNode;if(this.handles.indexOf(handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var offsets=Position.cumulativeOffset(this.activeHandle);this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}
else{this.active=false;}}}
Event.stop(event);}},update:function(event){if(this.active){if(!this.dragging)this.dragging=true;this.draw(event);if(Prototype.Browser.WebKit&&!event.touches)window.scrollBy(0,0);Event.stop(event);}},draw:function(event){var pointer=(event.touches?[event.touches[0].clientX,event.touches[0].clientY]:[Event.pointerX(event),Event.pointerY(event)]);var offsets=Position.cumulativeOffset(this.track);pointer[0]-=this.offsetX+offsets[0];pointer[1]-=this.offsetY+offsets[1];this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide)
this.options.onSlide(this.values.length>1?this.values:this.value,this);},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);Event.stop(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange)
this.options.onChange(this.values.length>1?this.values:this.value,this);this.event=null;},resize:function(){var slider=this;var onChange=this.options.onChange;this.options.onChange=null;this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?this.handles[0].offsetHeight:this.handles[0].offsetWidth;this.drawSpans();this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((slider.options.sliderValue instanceof Array?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);Element.makePositioned(h);Event.observe(h,"mousedown",slider.eventMouseDown);Event.observe(h,"touchstart",slider.eventMouseDown);});this.options.onChange=onChange;},needsResize:function(){var trackLength=this.trackLength;if(this.maximumOffset()==this.minimumOffset()){return false;}
this.trackLength=this.maximumOffset()-this.minimumOffset();var range=this.getRange(0);var span=this.spans[0];var expectedWidth=this.translateToPx(range.end-range.start+this.range.start,null);this.trackLength=trackLength;return span.style.width!=expectedWidth;}}
;var ManaPro=ManaPro||{};ManaPro.filterSlider=function(id,o){var s=new Control.PriceSlider([id+'-from',id+'-to'],id+'-track',{spans:[id+'-span'],restricted:true,range:$R(o.rangeFrom,o.rangeTo),sliderValue:[o.appliedFrom,o.appliedTo]});s.options.onSlide=function(value){var formattedValue=[o.numberFormat.replace('0',value[0].round()+''),o.numberFormat.replace('0',value[1].round()+'')];$(id+'-applied').update(o.appliedFormat.replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));};s.options.onChange=function(value){if(value[0]<=o.rangeFrom&&value[1]>=o.rangeTo){window.setLocation(o.clearUrl);}
else{var formattedValue=[value[0].round(),value[1].round()];window.setLocation(o.url.replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));}};};
;var ManaPro=ManaPro||{};var _mana_oldResizehandler={};var _mana_sliderTimers={};ManaPro.filterSuperSlider=function(id,o){var _changing=false;var $_from=jQuery('#'+id+'-applied input.m-slider.m-from');var $_to=jQuery('#'+id+'-applied input.m-slider.m-to');var _value=[parseFloat($_from.val()),parseFloat($_to.val())];function _round(value){if(o.existingValues.length){var distance=0;var found=-1;o.existingValues.each(function(item,index){if(found==-1||distance>=Math.abs(item-value)){found=index;distance=Math.abs(item-value);}});value=parseFloat(o.existingValues[found]);}
if(o.formatThreshold&&value>=o.formatThreshold){return o.decimalDigits2?parseFloat(value.toFixed(o.decimalDigits2)):value.round();}
else{return o.decimalDigits?parseFloat(value.toFixed(o.decimalDigits)):value.round();}}
function _format(value){if(o.formatThreshold&&value>=o.formatThreshold){value=_round(value)/o.formatThreshold;value=o.decimalDigits2?value.toFixed(o.decimalDigits2):value.round();return o.numberFormat2.replace('0',_formatNumber(value,o.decimalDigits2)+'');}
else{return o.numberFormat.replace('0',_formatNumber(_round(value),o.decimalDigits)+'');}}
function _formatNumber(value,decPlaces){var thouSeparator=o.thousandSeparator?o.groupSymbol:'';var decSeparator=o.decimalSymbol;var n=value;var
sign=n<0?"-":"",i=parseInt(n=Math.abs(+n||0).toFixed(decPlaces))+"",j=(j=i.length)>3?j%3:0;return sign
+(j?i.substr(0,j)
+thouSeparator:"")
+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thouSeparator)
+(decPlaces?decSeparator+Math.abs(n-i).toFixed(decPlaces).slice(2):"");}
function _change(value,undefined){if(_changing){return;}
_changing=true;if(value===undefined){value=[parseFloat($_from.val()),parseFloat($_to.val())];if(isNaN(value[0])||isNaN(value[1])){_changing=false;return;}
if(value[0]==_value[0]&&value[1]==_value[1]){_changing=false;return;}
else if(value[0]>value[1]){var t=value[0];value[0]=value[1];value[1]=t;}}
if(value[0]<=o.rangeFrom&&value[1]>=o.rangeTo){window.setLocation(jQuery.base64_decode(o.clearUrl));}
else{var formattedValue=[_round(value[0]),_round(value[1])];window.setLocation(jQuery.base64_decode(o.url).replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));}
_changing=false;}
var s=new Control.PriceSlider([id+'-from',id+'-to'],id+'-track',{spans:[id+'-span'],restricted:true,range:$R(o.rangeFrom,o.rangeTo),sliderValue:[o.appliedFrom,o.appliedTo]});s.options.onSlide=function(value){if(o.manualEntry){jQuery('#'+id+'-applied input.m-slider.m-from').val(_round(value[0]));jQuery('#'+id+'-applied input.m-slider.m-to').val(_round(value[1]));}
else{var formattedValue=[_format(value[0]),_format(value[1])];$(id+'-applied').update(o.appliedFormat.replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));$(id+'-range-from').update(o.appliedFormat.replace("__0__",formattedValue[0]).replace("to __1__",''));$(id+'-range-to').update(o.appliedFormat.replace("__0__",formattedValue[1]).replace("to __1__",''));}};s.options.onChange=_change;var _timer=null;$_from.change(function(event){if(!_timer){_timer=setTimeout(function(){clearTimeout(_timer);_timer=null;_change();},100);}}).keypress(function(e){if(e.which==13){if(!_timer){_timer=setTimeout(function(){clearTimeout(_timer);_timer=null;_change();},100);}}
else if(e.which==27){$_from.val(_value[0]);}}).focus(function(){var self=this;var focusing=setTimeout(function(){clearTimeout(focusing);focusing=null;$(self).select();},100);});$_to.change(function(){if(_timer){clearTimeout(_timer);_timer=null;}
_change();}).keypress(function(e){if(e.which==13){if(_timer){clearTimeout(_timer);_timer=null;}
_change();}
else if(e.which==27){$_to.val(_value[1]);}}).focus(function(){if(_timer){clearTimeout(_timer);_timer=null;}
var self=this;var focusing=setTimeout(function(){clearTimeout(focusing);focusing=null;$(self).select();},100);}).blur(function(){if(_timer){clearTimeout(_timer);_timer=null;}
_change();});function _resizeSpanAndHandles(forceResize){var checkFrequency=100,stabilityPeriod=500;var checkingForStability=false,currentlyStableFor=0;if(forceResize===true){s.resize();}
if(!_mana_sliderTimers[id]){_mana_sliderTimers[id]=setInterval(function(){if(s.needsResize()){s.resize();checkingForStability=false;}
else if(!checkingForStability){checkingForStability=true;currentlyStableFor=0;}
else if(currentlyStableFor>=stabilityPeriod){clearInterval(_mana_sliderTimers[id]);_mana_sliderTimers[id]=null;}
else{currentlyStableFor+=checkFrequency;}},checkFrequency);}}
if(_mana_oldResizehandler[id]){jQuery(window).unbind('resize',_mana_oldResizehandler[id]);_mana_oldResizehandler[id]=null;}
_mana_oldResizehandler[id]=_resizeSpanAndHandles;jQuery(_resizeSpanAndHandles);jQuery(window).bind('resize',_resizeSpanAndHandles);jQuery(document).bind('m-ajax-after',_resizeSpanAndHandles);jQuery('#'+id+'-track').parent().on('m-prepare',function(){_resizeSpanAndHandles(true);});jQuery(document).on('click','.toggle-content dl:first dt',function(){_resizeSpanAndHandles(true);});};ManaPro.filterAttributeSlider=function(id,o){function _indexOf(valueId){var result=-1;o.existingValues.each(function(item,index){if(item.id==valueId){result=index;}});return result;}
function _valueOf(index){index=index.round();return o.existingValues[index].id;}
function _labelOf(index){index=index.round();return o.existingValues[index].label;}
function _urlValueOf(index){index=index.round();return o.existingValues[index].url;}
function _prefixOf(index){index=index.round();return o.existingValues[index].prefix;}
function _change(value,undefined){var indexes=[value[0].round(),value[1].round()];s.values=indexes;s.value=s.values[0];s.handles[0].style[s.isVertical()?'top':'left']=s.translateToPx(indexes[0],0);s.handles[1].style[s.isVertical()?'top':'left']=s.translateToPx(indexes[1],1);s.drawSpans();if(indexes[0]<=_indexOf(o.rangeFrom)&&indexes[1]>=_indexOf(o.rangeTo)){window.setLocation(jQuery.base64_decode(o.clearUrl));}
else{var formattedValue=_prefixOf(indexes[0])+_urlValueOf(indexes[0])+o.separator+_urlValueOf(indexes[1]);window.setLocation(jQuery.base64_decode(o.url).replace("__0__",formattedValue));}}
var s=new Control.PriceSlider([id+'-from',id+'-to'],id+'-track',{spans:[id+'-span'],restricted:true,range:$R(_indexOf(o.rangeFrom),_indexOf(o.rangeTo)),sliderValue:[_indexOf(o.appliedFrom),_indexOf(o.appliedTo)]});s.options.onSlide=function(value){var formattedValue=[_labelOf(value[0]),_labelOf(value[1])];$(id+'-applied').update(o.appliedFormat.replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));};s.options.onChange=_change;function _resizeSpanAndHandles(forceResize){var checkFrequency=100,stabilityPeriod=500;var checkingForStability=false,currentlyStableFor=0;if(forceResize===true){s.resize();}
if(!_mana_sliderTimers[id]){_mana_sliderTimers[id]=setInterval(function(){if(s.needsResize()){s.resize();checkingForStability=false;}
else if(!checkingForStability){checkingForStability=true;currentlyStableFor=0;}
else if(currentlyStableFor>=stabilityPeriod){clearInterval(_mana_sliderTimers[id]);_mana_sliderTimers[id]=null;}
else{currentlyStableFor+=checkFrequency;}},checkFrequency);}}
if(_mana_oldResizehandler[id]){jQuery(window).unbind('resize',_mana_oldResizehandler[id]);_mana_oldResizehandler[id]=null;}
_mana_oldResizehandler[id]=_resizeSpanAndHandles;jQuery(_resizeSpanAndHandles);jQuery(window).bind('resize',_resizeSpanAndHandles);jQuery('#'+id+'-track').parent().on('m-prepare',function(){_resizeSpanAndHandles(true);});};ManaPro.filterRangeInput=function(id,o){var _changing=false;var $_from=jQuery('#'+id+'-applied input.m-slider.m-from');var $_to=jQuery('#'+id+'-applied input.m-slider.m-to');var _value=[parseFloat($_from.val()),parseFloat($_to.val())];function _round(value){if(o.formatThreshold&&value>=o.formatThreshold){return o.decimalDigits2?value.toFixed(o.decimalDigits2):value.round();}
else{return o.decimalDigits?value.toFixed(o.decimalDigits):value.round();}}
function _change(undefined){if(_changing){return;}
_changing=true;value=[parseFloat($_from.val()),parseFloat($_to.val())];if(isNaN(value[0])||isNaN(value[1])){_changing=false;return;}
if(value[0]==_value[0]&&value[1]==_value[1]){_changing=false;return;}
else if(value[0]>value[1]){var t=value[0];value[0]=value[1];value[1]=t;}
if(value[0]<=o.rangeFrom&&value[1]>=o.rangeTo){window.setLocation(jQuery.base64_decode(o.clearUrl));}
else{var formattedValue=[_round(value[0]),_round(value[1])];window.setLocation(jQuery.base64_decode(o.url).replace("__0__",formattedValue[0]).replace("__1__",formattedValue[1]));}
_changing=false;}
var _timer=null;$_from.change(function(event){if(!_timer){_timer=setTimeout(function(){clearTimeout(_timer);_timer=null;_change();},100);}}).keypress(function(e){if(e.which==13){if(!_timer){_timer=setTimeout(function(){clearTimeout(_timer);_timer=null;_change();},100);}}
else if(e.which==27){$_from.val(_value[0]);}}).focus(function(){var self=this;var focusing=setTimeout(function(){clearTimeout(focusing);focusing=null;$(self).select();},100);});$_to.change(function(){if(_timer){clearTimeout(_timer);_timer=null;}
_change();}).keypress(function(e){if(e.which==13){if(_timer){clearTimeout(_timer);_timer=null;}
_change();}
else if(e.which==27){$_to.val(_value[1]);}}).focus(function(){if(_timer){clearTimeout(_timer);_timer=null;}
var self=this;var focusing=setTimeout(function(){clearTimeout(focusing);focusing=null;$(self).select();},100);}).blur(function(){if(_timer){clearTimeout(_timer);_timer=null;}
_change();});};
;(function($){var _isCollapsedByDefault=false;var _expandSelected=false;function _collapse(item,showEffect){var li=item.parent();if(!li.hasClass('m-animating')){if(showEffect){_saveState(item,true);li.addClass('m-animating');li.children('ul').slideUp('fast',function(){li.removeClass('m-animating').removeClass('m-expanded').addClass('m-collapsed');});}
else{li.children('ul').hide();li.removeClass('m-expanded').addClass('m-collapsed');}}}
function _expand(item,showEffect){var li=item.parent();if(!li.hasClass('m-animating')){if(showEffect){_saveState(item,false);li.addClass('m-animating');li.children('ul').slideDown('fast',function(){li.removeClass('m-animating').removeClass('m-collapsed').addClass('m-expanded');});}
else{li.children('ul').show();li.removeClass('m-collapsed').addClass('m-expanded');}}}
var _state={};function _saveState(item,liState){var tree=item.parents('.m-tree');if(tree.length){var treeId=tree[0].id;var itemId=item[0].id;var isCollapsed=liState;if(_isCollapsedByDefault){isCollapsed=!isCollapsed;}
if(!_state[treeId]){_state[treeId]={};}
_state[treeId][itemId]=isCollapsed?1:0;$.post($.options('#m-tree').url,{state:_state});}}
function _loadState(){_isCollapsedByDefault=$.options&&$.options('#m-tree')&&$.options('#m-tree').collapsedByDefault;_expandSelected=$.options&&$.options('#m-tree')&&$.options('#m-tree').expandSelected;if(!_state.length&&$.options&&$.options('#m-tree')&&$.options('#m-tree').state){_state=$.options('#m-tree').state;}
$('.m-tree-item').each(function(){var item=$(this);var tree=item.parents('.m-tree');if(tree.length){var li=item.parent();if(li.children('ul').length){var treeId=tree[0].id;var itemId=item[0].id;var isCollapsed;if(li.find('ul .m-selected-filter-item').length){isCollapsed=false;}
else if(li.find('.m-selected-filter-item').length&&_expandSelected){isCollapsed=false;}
else{isCollapsed=_state[treeId]&&_state[treeId][itemId]==1;if(_isCollapsedByDefault){isCollapsed=!isCollapsed;}}
if(isCollapsed){_collapse($(this),false);}
else{_expand($(this),false);}}
else{li.addClass('m-leaf');}}});}
$(function(){_loadState();$('.m-tree-item').live('click',function(e){if($(e.target).prop("tagName").toLowerCase()=='a'){return true;}
if($(this).parent().hasClass('m-collapsed')){_expand($(this),true);return false;}
else if($(this).parent().hasClass('m-expanded')){_collapse($(this),true);return false;}});});$(document).bind('m-ajax-after',function(e,selectors,productsClicked){_loadState();});})(jQuery);