if(/#/.test(window.location)&&!/#\/search/.test(window.location)){if(/\?/.test(window.location)){if(/\?#/.test(window.location.href)||/#\?/.test(window.location.href)){window.location=window.location.href.replace("#","").replace(/&ts=[^&]+/,"")}else{if(/\?.*#/.test(window.location.href)){window.location=window.location.href.replace("#","&").replace(/&ts=[^&]+/,"")}}}else{window.location=window.location.href.replace("#","?").replace(/&ts=[^&]+/,"")}}(function(window,document,$){var SLI=window.SLI=window.SLI||{};
var TEMPLATE_ID_REGEX=/([&\?]ts=)[^&;"']+/g;SLI.paramPosition=function(url,param){var paramBit="&"+param+"=";var paramStart=url.indexOf(paramBit);if(paramStart==-1){paramStart=url.indexOf("?"+param+"=")}var paramEnd=url.indexOf("&",paramStart+1);return{start:(paramStart<0)?null:paramStart+paramBit.length,end:(paramEnd<0)?null:paramEnd}};SLI.paramFromUrl=function(url,param){var pos=SLI.paramPosition(url,param);return pos.start?decodeURIComponent(url.substring(pos.start,pos.end||url.length)):""};SLI.replaceParamInUrl=function(url,param,value){var separator=url.indexOf("?")==-1?"?":"&";
var paramBit=separator+param+"=";var hasValue=!!value;var newHref=hasValue?url+paramBit+value:url;var pos=SLI.paramPosition(url,param);if(pos.start){newHref=url.substring(0,pos.start-(hasValue?0:paramBit.length))+value;if(pos.end){newHref+=url.substring(pos.end)}}return newHref};SLI.backToTop=function(){$.scrollTo(0,800)};SLI.setTitle=function(title){document.title=title};SLI.load=function(content,selector,backtotop){var searchId=SLI.config.search.templateId||"custom";content=(content||"").replace(/search#\?/g,"search?").replace(TEMPLATE_ID_REGEX,"$1"+searchId);
var $el=$(selector);$el.toggle(content.length>0).html(content);if(backtotop){$(selector).find(backtotop).unbind();$(selector).find(backtotop).click(SLI.backToTop)}return SLI};function RefinementControl(options){if(!options){throw new Error("Need to pass options")}var url=window.location.href||"";this._baseUrl=url;var state=this.extractState(url);this._url=state.url;this._modified={};this.$spinner=options.spinner||$('<div id="sli_ajax_spinner"></div>');if(!options.products){throw new Error("Product selection not supplied")
}this.$products=options.products;history.replaceState(state,document.title,document.location.href)}RefinementControl.prototype={extractState:function(queryString){var state={};state.url=queryString;return state},currentState:function(){return{url:this._url}},getCurrentPage:function(){return this._url},setCurrentPage:function(url){if(this._url==url){return}this._url=url;this._modified.url=true},resetQuery:function(keyword,action){var url=this.getCurrentPage();var view=SLI.paramFromUrl(url,"view");var searchString="?w="+keyword;
if(view!==""){searchString+="&view="+view}var newUrl=action+searchString;this.setCurrentPage(newUrl);this.pageRefresh(this.currentState(),false,newUrl)},setPageRefresh:function(url){this.setCurrentPage(url);this.pageRefresh(this.currentState(),false,url)},pageRefresh:function(state,back,ajaxUrl){if(this._xhr){this._xhr.abort()}if(!ajaxUrl){ajaxUrl=state.url}var templateId=SLI.config.search.templateId||"custom";var ajaxId=SLI.config.ajax.templateId||"ajax";var racId=SLI.config.rac.templateId||"rac";if(ajaxUrl.indexOf("ts="+racId)!==-1){var urlRedirectParam=SLI.paramFromUrl(ajaxUrl,"url");
var newAjaxUrl=decodeURIComponent(urlRedirectParam);var tsCheck=SLI.paramFromUrl(newAjaxUrl,"ts");if(tsCheck!==""){urlRedirectParam=SLI.replaceParamInUrl(newAjaxUrl,"ts",ajaxId);urlRedirectParam=encodeURIComponent(urlRedirectParam)}else{urlRedirectParam=encodeURIComponent(urlRedirectParam+"&ts="+ajaxId)}var url=SLI.replaceParamInUrl(ajaxUrl,"url",urlRedirectParam);ajaxUrl=newAjaxUrl;this.setCurrentPage(ajaxUrl)}else{if(!SLI.config.ajax.ln){var url=SLI.replaceParamInUrl(ajaxUrl,"ts",ajaxId)}else{if(ajaxUrl.indexOf("?")==-1){var url=ajaxUrl+"?ts="+ajaxId
}else{var url=ajaxUrl+"&ts="+ajaxId}}}var this_R=this;var $blank=$("<div/>").height(600).append(this.$spinner);this.$products.html($blank);this._xhr=$.ajax({url:url,method:"GET",dataType:"html",cache:true,ifModified:true}).done(function(data){if(window.location.href.indexOf("sli_jump=1")===-1){var dataHead=data.substr(0,512);if(dataHead.indexOf("<!--JUMPTOURL=")!==-1){var jumpReg=new RegExp("<!--JUMPTOURL='([^']*)'-->");var m=jumpReg.exec(data);if(m!==null){window.location=m[1];return}}}if(!back&&history&&history.pushState){history.pushState(state,null,ajaxUrl)
}data=data.replace(/search#\?/g,"search?").replace(TEMPLATE_ID_REGEX,"$1"+templateId);this_R.$products.html(data);if(jQuery.sliAnimateFinished!=undefined){jQuery.sliAnimateFinished()}this_R._modified={}}).fail(function(jqXHR,textStatus){if(textStatus!=="abort"){window.location=ajaxUrl}})},rebuildState:function(state){this._url=state.url;this._modified={url:true};this.pageRefresh(state,true)}};SLI.RefinementControl=RefinementControl;var CLICK="click";var CHANGE="change";var SUBMIT="submit";$(document).ready(function(){var SLI=window.SLI=window.SLI||{};
var r=SLI.controller=new SLI.RefinementControl({products:$(SLI.config.ajax.productsDiv)});function checkDomain(newHref){var searchRegex=/^([^\?]+)/,lnRegex=window.location.protocol+"//"+window.location.host+"/"+SLI.config.ajax.lnpath,lnRegexSearch=window.location.protocol+"//"+window.location.host+"/search",ajaxUrl=false,queryParams=[],currentQueryParams=[],currentQueryStr=window.location.search,currentQueryArr=currentQueryStr.replace("?","").split("&"),queryChanged=false,locationMatch;if(SLI.config.ajax.ln){if(newHref.indexOf(lnRegex)!==-1){return true
}else{if(newHref.indexOf(lnRegexSearch)!==-1){return true}else{return false}}}else{if(locationMatch=searchRegex.exec(newHref)){var domainCheck=window.location.protocol+"//"+window.location.host+window.location.pathname;if(locationMatch[1]===domainCheck){return true}else{return false}}else{return false}}}function fireAjax(url,element){var queryType=SLI.paramFromUrl(url,"p");var racClick=SLI.paramFromUrl(url,"rt");if(queryType!=="R"){r.setPageRefresh(url);return true}else{if(racClick!=="racclick"&&racClick!==""){r.setPageRefresh(url);
return true}else{return false}}}function submitForm(ajaxUrl,action,form){var racElementSelected=false;if(jQuery("#sli_autocomplete li ul li").hasClass("sli_ac_active")){racElementSelected=true}if(!racElementSelected){var keyword=encodeURIComponent(form.w.value);if(keyword==""){alert("Please enter a keyword and try again.")}else{if(!ajaxUrl){window.location=action+"?w="+keyword}else{r.resetQuery(keyword,action)}}}}SLI.ajaxFormSubmit=function(form){var ajaxUrl=checkDomain(form.action);submitForm(ajaxUrl,form.action,form);
return false};SLI.ajaxSearchSubmit=function(url){if(SLI.config.ajax.enabled){var ajaxUrl=checkDomain(url);if(!ajaxUrl){window.location=url}else{if(!fireAjax(url,this)){window.location=url}}}else{window.location=url}};if(SLI.config.ajax.enabled){window.onpopstate=function(event){if(!event.state){return}r.rebuildState(event.state)};$("body").on(CLICK,"a",function(e,options){options=options||{};if(!options.continue_normal){var ajaxUrl=checkDomain(this.getAttribute("href"));if(!ajaxUrl){return true}else{if(!fireAjax(this.getAttribute("href"),this)){return true
}else{return false}}}else{return true}})}})})(window,document,jQuery);jQuery.extend({sliAnimateOutCustom:undefined});function sli_setTitle(title){document.title=title}function sli_loadContent(content,location,scrollToTop){SLI.load(content,location,scrollToTop)};