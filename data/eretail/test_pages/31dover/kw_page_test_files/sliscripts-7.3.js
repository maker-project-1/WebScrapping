(function(window,undefined){window.SLI=window.SLI||{};window.SLI.console={log:window.console?console.log:function(a){}};function afPosition(href){var afStart=href.indexOf("&af=");if(afStart==-1){afStart=href.indexOf("?af=")}var afEnd=href.indexOf("&",afStart+1);return{start:(afStart===-1)?null:afStart+4,end:(afEnd===-1)?null:afEnd}}function afFromUrl(href){var afPos=afPosition(href);if(afPos.end){href=afPos.start?href.substring(afPos.start,afPos.end):""}else{href=afPos.start?href.substring(afPos.start):""}return href.replace(/%20/g," ").replace(/%3[aA]/g,":")
}function replaceAfInUrl(af,href){af=!!af?"af="+af:"";var afPos=afPosition(href);if(afPos.start){var tmp=href.substring(0,afPos.start-4);if(afPos.end){tmp=urlCat(tmp,href.substring(afPos.end))}href=tmp}return urlCat(href,af)}function urlCat(href,appendage){if(typeof appendage=="undefined"||appendage==""){return href}var separator=href.indexOf("?")==-1?"?":"&";if(appendage.charAt(0)=="?"||appendage.charAt(0)=="&"){appendage=appendage.substr(1)}return href+separator+appendage}function tokeniseAf(af){var afParts=af.split(" ");
var tokens=[];for(var i=0;i<afParts.length;i++){var tokenParts=afParts[i].split(":");if(tokenParts[0]&&tokenParts[1]){tokens.push({facet:tokenParts[0],value:tokenParts[1]})}}return tokens}function afFromTokens(tokens){var af="";for(var i=0;i<tokens.length;i++){if(tokens[i].facet&&tokens[i].value){af+=tokens[i].facet+":"+tokens[i].value+" "}}return af.replace(/\s+$/,"")}function updateFacet(tokens,facet,value,prepend){var facetIndex=-1;for(var i=0;i<tokens.length;i++){if(tokens[i].facet===facet){if(!prepend){facetIndex=i;
if(tokens[i].value===value){tokens.splice(i,1);break}tokens[i].value=value}else{if(tokens[i].value===value){facetIndex=i;tokens.splice(i,1);break}}}}if(facetIndex===-1){tokens.unshift({facet:facet,value:value})}return tokens}function facetsFrom(tokens,facet,value){var facetIndex=-1;for(var i=0;i<tokens.length;i++){if(tokens[i].facet===facet){if(!!value&&tokens[i].value===value){facetIndex=i;break}else{if(!value){facetIndex=i;break}}}}if(facetIndex!==-1){return tokens.slice(facetIndex)}else{return tokens}}processFacets=function(extraHref,facet,value,multi){var facetUrl=window.SLI.facetUrl||window.facet_url;
if(!facetUrl){facetUrl=""}var href=urlCat(facetUrl,extraHref);if(!facet){return href}var afTokens=tokeniseAf(afFromUrl(href));if(!value){value=""}afTokens=updateFacet(afTokens,facet,value,(multi&&value));return replaceAfInUrl(afFromTokens(afTokens),href)};removeFacets=function(extraHref,facet,value){var facetUrl=window.SLI.facetUrl||window.facet_url;if(!facetUrl){facetUrl=""}var href=urlCat(facetUrl,extraHref);if(!facet){return href}var afTokens=tokeniseAf(afFromUrl(href));afTokens=facetsFrom(afTokens,facet,value);
return replaceAfInUrl(afFromTokens(afTokens),href)};resetFacets=function(extraHref){var facetUrl=window.SLI.facetUrl||window.facet_url;if(!facetUrl){facetUrl=""}facetUrl=facetUrl.replace(/&af=[^&]+/,"").replace(/\?af=[^&]+/,"?").replace(/\?&/,"?");if(facetUrl.slice(-1)=="?"){facetUrl=facetUrl.slice(0,-1)}return urlCat(facetUrl,extraHref)};window.SLI._processFacets=processFacets;window.SLI._resetFacets=resetFacets;window.SLI._removeFacets=removeFacets;window.SLI.processFacets=function(extraHref,facet,value,multi){document.location=processFacets(extraHref,facet,value,multi)
};window.SLI.resetFacets=function(extraHref){document.location=resetFacets(extraHref)};window.SLI.removeFacets=function(extraHref,facet,value){document.location=removeFacets(extraHref,facet,value)};if(!window.facet_url&&!window.SLI.facetUrl){SLI.console.log("SLI Critical JavaScript error. Facet URL is not defined.")}})(window);(function(jQuery){jQuery.equalizeHeight=function(options){var new_height=0;var first_item=0;var elem_selector=options.element;var elements=jQuery(elem_selector);elements.each(function(i,n){var item=jQuery(n);
var item2=jQuery(elements[i+1]);if(i==(elements.size()-1)){var title_height=item.height();if(title_height>new_height){new_height=title_height}elements.slice(first_item,(i+1)).height(new_height)}else{var top=item.offset().top;var top2=item2.offset().top;var title_height=item.height();if(title_height>new_height){new_height=title_height}if(top2>top){elements.slice(first_item,(i+1)).height(new_height);new_height=0;first_item=i+1}}})}})(jQuery);